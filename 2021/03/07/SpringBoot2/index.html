

<!DOCTYPE html>
<html lang="en" color-mode=light>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>SpringBoot 知识汇总 - 周瑜的小家园</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="google" content="notranslate" />
  
  <meta name="description" content="一.容器功能1.底层注解@Configuration详...">
  <meta name="author" content="周瑜">
  <link rel="icon" href="/images/icons/favicon-16x16.png" type="image/png" sizes="16x16">
  <link rel="icon" href="/images/icons/favicon-32x32.png" type="image/png" sizes="32x32">
  <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png" sizes="180x180">
  <meta rel="mask-icon" href="/images/icons/stun-logo.svg" color="#333333">
  
    <meta rel="msapplication-TileImage" content="/images/icons/favicon-144x144.png">
    <meta rel="msapplication-TileColor" content="#000000">
  

  
<link rel="stylesheet" href="/css/style.css">


  
    
<link rel="stylesheet" href="//at.alicdn.com/t/font_1445822_s6x2xcokxrl.css">

  

  
    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css">

  

  
    
      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/xcode.min.css" name="highlight-style" mode="light">

      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/solarized-dark.min.css" name="highlight-style" mode="dark">

      
  

  <script>
    var CONFIG = window.CONFIG || {};
    var ZHAOO = window.ZHAOO || {};
    CONFIG = {
      isHome: false,
      fancybox: true,
      pjax: false,
      lazyload: {
        enable: true,
        only_post: 'false',
        loading: '/images/theme/loading.gif'
      },
      donate: {
        enable: true,
        alipay: 'https://pic.izhaoo.com/alipay.jpg',
        wechat: 'https://pic.izhaoo.com/wechat.jpg'
      },
      galleries: {
        enable: true
      },
      fab: {
        enable: true,
        always_show: false
      },
      carrier: {
        enable: true
      },
      daovoice: {
        enable: false
      },
      preview: {
        background: {
          default: '/images/theme/welcome-image.jpg',
          api: ''
        },
        motto: {
          default: '无法让步的有两件事，幸福和周瑜大人。',
          api: 'https://v2.jinrishici.com/one.json',
          data_contents: '["data","content"]'
        },
      },
      qrcode: {
        enable: true,
        type: 'url',
        image: 'https://pic.izhaoo.com/weapp-code.jpg',
      },
      toc: {
        enable: true
      },
      scrollbar: {
        type: 'simple'
      },
      notification: {
        enable: false,
        delay: 4500,
        list: '',
        page_white_list: '',
        page_black_list: ''
      }
    }
  </script>

  

  

<meta name="generator" content="Hexo 4.2.1"></head>

<body class="lock-screen">
  <div class="loading"></div>
  


  <nav class="navbar">
    <div class="left">
      
        <i class="iconfont iconqrcode j-navbar-qrcode"></i>
      
      
        <i class="iconfont iconmoono" id="color-toggle" color-toggle="light"></i>
      
    </div>
    <div class="center">SpringBoot 知识汇总</div>
    <div class="right">
      <i class="iconfont iconmenu j-navbar-menu"></i>
    </div>
    
      <div id="qrcode-navbar"></div>
    
  </nav>

  

<nav class="menu">
  <div class="menu-wrap">
    <div class="menu-close">
      <i class="iconfont iconbaseline-close-px"></i>
    </div>
    <ul class="menu-content"><li class="menu-item">
        <a href="/ " class="underline "> 首页</a>
      </li><li class="menu-item">
        <a href="/galleries/ " class="underline "> 摄影</a>
      </li><li class="menu-item">
        <a href="/archives/ " class="underline "> 归档</a>
      </li><li class="menu-item">
        <a href="/tags/ " class="underline "> 标签</a>
      </li><li class="menu-item">
        <a href="/categories/ " class="underline "> 分类</a>
      </li><li class="menu-item">
        <a href="/about/ " class="underline "> 关于</a>
      </li></ul>
    
      <div class="menu-copyright"><p>Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  Theme - <a target="_blank" href="https://github.com/izhaoo/hexo-theme-zhaoo">fan</a></p></div>
    
  </div>
</nav>
  <main id="main">
  <div class="article-wrap">
    <div class="row container">
      <div class="col-xl-3"></div>
      <div class="col-xl-6"><article class="article">
  <div class="wrap">
    <section class="head">
  <img   class="lazyload" data-original="/images/theme/post-image.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false">
  <div class="head-mask">
    <h1 class="head-title">SpringBoot 知识汇总</h1>
    <div class="head-info">
      <span class="post-info-item"><i class="iconfont iconcalendar"></i>March 07, 2021</span>
      
      <span class="post-info-item"><i class="iconfont iconfont-size"></i>51156</span>
    </div>
  </div>
</section>
    <section class="main">
      <section class="content">
        <h3 id="一-容器功能"><a href="#一-容器功能" class="headerlink" title="一.容器功能"></a>一.容器功能</h3><h4 id="1-底层注解-Configuration详解"><a href="#1-底层注解-Configuration详解" class="headerlink" title="1.底层注解@Configuration详解"></a>1.底层注解@Configuration详解</h4><p>@Configuration：告诉springboot这是一个配置类 == 配置文件 ， 配置类本身也是组件</p>
<p>@Bean：给容器中添加组件。以方法名作为组件id，返回类型是组件类型，返回的值就是组件在容器中的实列 ==<bean></bean></p>
<p>proxyBeanMethods：代理bean的方法</p>
<h4 id="实战作用"><a href="#实战作用" class="headerlink" title="实战作用"></a>实战作用</h4><ol>
<li>配置类组件之间无依赖关系用Lite模式加速容器启动过程，减少判断</li>
<li>配置类组件之间有依赖关系，方法会被调用得到之前单实例组件，用Full模式</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 1.proxyBeanMethods:代理bean的方法</span><br><span class="hljs-comment"> * Full：(proxyBeanMethods = turn) 全模式</span><br><span class="hljs-comment"> * Lite：(proxyBeanMethods = false) 轻量级模式</span><br><span class="hljs-comment"> * 组件依赖</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Configuration</span>(proxyBeanMethods = <span class="hljs-keyword">true</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Myconfig</span> </span>&#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Users <span class="hljs-title">users</span><span class="hljs-params">()</span></span>&#123;<br>        Users user = <span class="hljs-keyword">new</span> Users(<span class="hljs-string">"张三"</span>,<span class="hljs-number">20</span>);<br>        <span class="hljs-comment">//users组件依赖了pet组件</span><br>       user.setPet(pet());<br>        <span class="hljs-keyword">return</span> user;<br>    &#125;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Pet <span class="hljs-title">pet</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Pet(<span class="hljs-string">"旺财"</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br>    ApplicationContext ioc; <span class="hljs-comment">//获取ioc容器</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//查看容器中的组件</span><br>        String[] names = ioc.getBeanDefinitionNames();<br>        <span class="hljs-keyword">for</span>(String name : names)&#123;<br>            System.out.println(name);<br>        &#125;<br>        <span class="hljs-comment">//从容器中获取组件</span><br>        Pet tom01 = ioc.getBean(<span class="hljs-string">"pet"</span>,Pet<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>        Pet tom02 = ioc.getBean(<span class="hljs-string">"pet"</span>,Pet<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>        System.out.println(<span class="hljs-string">"组件："</span>+(tom01 == tom02));<br>        <span class="hljs-comment">//com.project5.project5.config.Myconfig$$EnhancerBySpringCGLIB$$193ccc23@440eaa07</span><br>        Myconfig myconfig = ioc.getBean(Myconfig<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>        System.out.println(<span class="hljs-string">"myconfig"</span>+myconfig);<br>        <span class="hljs-comment">//如果@Configuration(proxyBeanMethods = true) 代理对象调用方法。Spring Boot总会检查这个组件是否存在容器中</span><br>        <span class="hljs-comment">//保持组件单实例</span><br>        Users user = myconfig.users();<br>        Users user1 = myconfig.users();<br>        System.out.println(user == user1);<br>        Users user01 = ioc.getBean(<span class="hljs-string">"users"</span>,Users<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>        Pet tom = ioc.getBean(<span class="hljs-string">"pet"</span>,Pet<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>        System.out.println(<span class="hljs-string">"用户的宠物"</span>+(user01.getPet() == tom));<br>    &#125;<br></code></pre></td></tr></table></figure>

<h4 id="2-Import注解"><a href="#2-Import注解" class="headerlink" title="2.@Import注解"></a>2.@Import注解</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@Import</span>(&#123;Users<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">DBHelper</span>.<span class="hljs-title">class</span>&#125;)</span><br></code></pre></td></tr></table></figure>

<h4 id="3-Conditional"><a href="#3-Conditional" class="headerlink" title="3.@Conditional"></a>3.@Conditional</h4><p>@Conditional：条件装配，满足Conditional指定的条件，则进行组件注入</p>
<h4 id="4-ImportResource"><a href="#4-ImportResource" class="headerlink" title="4.@ImportResource"></a>4.@ImportResource</h4><p>@ImportResource(“classpath:beans.xml”)导入spring的配置文件，使其生效</p>
<h4 id="5-配置绑定"><a href="#5-配置绑定" class="headerlink" title="5.配置绑定"></a>5.配置绑定</h4><h5 id="（1）-Component-ConfigurationProperties"><a href="#（1）-Component-ConfigurationProperties" class="headerlink" title="（1）@Component  +  @ConfigurationProperties"></a>（1）@Component  +  @ConfigurationProperties</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@Component</span>  <span class="hljs-comment">//将组件加入到容器中，只有在容器中的组件，才能得到springBoot的强大支持</span><br><span class="hljs-meta">@ConfigurationProperties</span>(prefix = <span class="hljs-string">"mycat"</span>)  <span class="hljs-comment">//将配置文件中前置为mycat的配置加载到组件中</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span> </span>&#123;<br>    <span class="hljs-keyword">private</span>  String name;<br>    <span class="hljs-keyword">private</span> Integer money;<br></code></pre></td></tr></table></figure>

<h5 id="（2）-ConfigurationProperties-EnableConfigurationProperties"><a href="#（2）-ConfigurationProperties-EnableConfigurationProperties" class="headerlink" title="（2）@ConfigurationProperties  +  @EnableConfigurationProperties"></a>（2）@ConfigurationProperties  +  @EnableConfigurationProperties</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@EnableConfigurationProperties</span>(Cat<span class="hljs-class">.<span class="hljs-keyword">class</span>)  //开启<span class="hljs-title">Cat</span>配置绑定功能，把<span class="hljs-title">Cat</span>这个组件自动注册到容器中</span><br><span class="hljs-class"><span class="hljs-title">public</span> <span class="hljs-title">class</span> <span class="hljs-title">Myconfig</span> </span>&#123;<br></code></pre></td></tr></table></figure>

<h3 id="二-自动配置原理"><a href="#二-自动配置原理" class="headerlink" title="二.自动配置原理"></a>二.自动配置原理</h3><h4 id="1-引导加载自动配置类"><a href="#1-引导加载自动配置类" class="headerlink" title="1.引导加载自动配置类"></a>1.引导加载自动配置类</h4><h5 id="1-SpringBootApplication由下面几个注解组成"><a href="#1-SpringBootApplication由下面几个注解组成" class="headerlink" title="(1)SpringBootApplication由下面几个注解组成"></a>(1)SpringBootApplication由下面几个注解组成</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootConfiguration</span><br><span class="hljs-meta">@EnableAutoConfiguration</span><br><span class="hljs-meta">@ComponentScan</span>(<br>    excludeFilters = &#123;<span class="hljs-meta">@Filter</span>(<br>    type = FilterType.CUSTOM,<br>    classes = &#123;TypeExcludeFilter<span class="hljs-class">.<span class="hljs-keyword">class</span>&#125;</span><br><span class="hljs-class">), @<span class="hljs-title">Filter</span>(</span><br><span class="hljs-class">    <span class="hljs-title">type</span> </span>= FilterType.CUSTOM,<br>    classes = &#123;AutoConfigurationExcludeFilter<span class="hljs-class">.<span class="hljs-keyword">class</span>&#125;</span><br><span class="hljs-class">)&#125;</span><br><span class="hljs-class">)</span><br></code></pre></td></tr></table></figure>

<p>​    (1.1).@SpringBootConfiguration</p>
<p>​    @Configuration : 代表当前是一个配置类</p>
<p>（1.2）@ComponentScan</p>
<p>​    指定扫描哪些，spring注解；</p>
<h5 id="（1-3）-EnableAutoConfiguration"><a href="#（1-3）-EnableAutoConfiguration" class="headerlink" title="（1.3）@EnableAutoConfiguration"></a>（1.3）@EnableAutoConfiguration</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@AutoConfigurationPackage</span><br><span class="hljs-meta">@Import</span>(&#123;AutoConfigurationImportSelector<span class="hljs-class">.<span class="hljs-keyword">class</span>&#125;)</span><br><span class="hljs-class"><span class="hljs-title">public</span> @<span class="hljs-title">interface</span> <span class="hljs-title">EnableAutoConfiguration</span> </span>&#123;<br></code></pre></td></tr></table></figure>

<p>​    (1.3.1) @AutoConfigurationPackage</p>
<p>自动配置包？指定了默认的包规则</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Import</span>(&#123;Registrar<span class="hljs-class">.<span class="hljs-keyword">class</span>&#125;) //给容器中导入一个组件</span><br><span class="hljs-class"><span class="hljs-title">public</span> @<span class="hljs-title">interface</span> <span class="hljs-title">AutoConfigurationPackage</span> </span>&#123;<br>    <span class="hljs-comment">//利用Registrar给容器中导入一系列组件</span><br>    <span class="hljs-comment">//将指定的一个包下的所有组件导进来？主程序所在的包下</span><br></code></pre></td></tr></table></figure>

<p>（1.3.2）@Import({AutoConfigurationImportSelector.class})</p>
<p>​       </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">1</span>.利用<span class="hljs-keyword">this</span>.getAutoConfigurationEntry(annotationMetadata);方法，给容器中批量导入一些组件<br><span class="hljs-number">2</span>.调用List&lt;String&gt; configurations = <span class="hljs-keyword">this</span>.getCandidateConfigurations(annotationMetadata, attributes);获取到所有需要导入到容器中的组件<br><span class="hljs-number">3</span>.利用工厂加载Map&lt;String, List&lt;String&gt;&gt; loadSpringFactories(ClassLoader classLoader)得到所有组件<br><span class="hljs-number">4</span>.从META-INF/spring.factories位置来加载一个文件。<br>    默认扫描我们当前系统里面所有META-INF/spring.factories位置的文件<br>    spring-boot-autoconfigure-<span class="hljs-number">2.4</span><span class="hljs-number">.3</span>RELEASE.jar里面也有META-INF/spring.factories<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><code class="hljs java">文件里写死了spring-boot一启动就要给容器中加载的所有配置类<br>路径 spring-boot-autoconfigure-<span class="hljs-number">2.4</span><span class="hljs-number">.3</span>RELEASE.jar/META-INF/spring.factories<br># Auto Configure<br>org.springframework.boot.autoconfigure.EnableAutoConfiguration=\<br>org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\<br>org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\<br>org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\<br>org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\<br>org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration,\<br>org.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration,\<br>org.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.context.LifecycleAutoConfiguration,\<br>org.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration,\<br>org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration,\<br>org.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration,\<br>org.springframework.boot.autoconfigure.dao.PersistenceExceptionTranslationAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveDataAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.cassandra.CassandraRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.couchbase.CouchbaseDataAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveDataAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.couchbase.CouchbaseRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchDataAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.elasticsearch.ReactiveElasticsearchRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.elasticsearch.ReactiveElasticsearchRestClientAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.jdbc.JdbcRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.ldap.LdapRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.mongo.MongoReactiveDataAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.mongo.MongoReactiveRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.mongo.MongoRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.neo4j.Neo4jDataAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.neo4j.Neo4jReactiveDataAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.neo4j.Neo4jReactiveRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.neo4j.Neo4jRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.solr.SolrRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.r2dbc.R2dbcDataAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.r2dbc.R2dbcRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.redis.RedisReactiveAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.rest.RepositoryRestMvcAutoConfiguration,\<br>org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration,\<br>org.springframework.boot.autoconfigure.elasticsearch.ElasticsearchRestClientAutoConfiguration,\<br>org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration,\<br>org.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration,\<br>org.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration,\<br>org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration,\<br>org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration,\<br>org.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration,\<br>org.springframework.boot.autoconfigure.hazelcast.HazelcastAutoConfiguration,\<br>org.springframework.boot.autoconfigure.hazelcast.HazelcastJpaDependencyAutoConfiguration,\<br>org.springframework.boot.autoconfigure.http.HttpMessageConvertersAutoConfiguration,\<br>org.springframework.boot.autoconfigure.http.codec.CodecsAutoConfiguration,\<br>org.springframework.boot.autoconfigure.influx.InfluxDbAutoConfiguration,\<br>org.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration,\<br>org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jdbc.JndiDataSourceAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jdbc.XADataSourceAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jms.JmsAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jms.JndiConnectionFactoryAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jms.activemq.ActiveMQAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jms.artemis.ArtemisAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jersey.JerseyAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jooq.JooqAutoConfiguration,\<br>org.springframework.boot.autoconfigure.jsonb.JsonbAutoConfiguration,\<br>org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration,\<br>org.springframework.boot.autoconfigure.availability.ApplicationAvailabilityAutoConfiguration,\<br>org.springframework.boot.autoconfigure.ldap.embedded.EmbeddedLdapAutoConfiguration,\<br>org.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration,\<br>org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration,\<br>org.springframework.boot.autoconfigure.mail.MailSenderAutoConfiguration,\<br>org.springframework.boot.autoconfigure.mail.MailSenderValidatorAutoConfiguration,\<br>org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration,\<br>org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,\<br>org.springframework.boot.autoconfigure.mongo.MongoReactiveAutoConfiguration,\<br>org.springframework.boot.autoconfigure.mustache.MustacheAutoConfiguration,\<br>org.springframework.boot.autoconfigure.neo4j.Neo4jAutoConfiguration,\<br>org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\<br>org.springframework.boot.autoconfigure.quartz.QuartzAutoConfiguration,\<br>org.springframework.boot.autoconfigure.r2dbc.R2dbcAutoConfiguration,\<br>org.springframework.boot.autoconfigure.r2dbc.R2dbcTransactionManagerAutoConfiguration,\<br>org.springframework.boot.autoconfigure.rsocket.RSocketMessagingAutoConfiguration,\<br>org.springframework.boot.autoconfigure.rsocket.RSocketRequesterAutoConfiguration,\<br>org.springframework.boot.autoconfigure.rsocket.RSocketServerAutoConfiguration,\<br>org.springframework.boot.autoconfigure.rsocket.RSocketStrategiesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.servlet.SecurityFilterAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.reactive.ReactiveSecurityAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.reactive.ReactiveUserDetailsServiceAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.rsocket.RSocketSecurityAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.saml2.Saml2RelyingPartyAutoConfiguration,\<br>org.springframework.boot.autoconfigure.sendgrid.SendGridAutoConfiguration,\<br>org.springframework.boot.autoconfigure.session.SessionAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.oauth2.client.servlet.OAuth2ClientAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.oauth2.client.reactive.ReactiveOAuth2ClientAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.oauth2.resource.servlet.OAuth2ResourceServerAutoConfiguration,\<br>org.springframework.boot.autoconfigure.security.oauth2.resource.reactive.ReactiveOAuth2ResourceServerAutoConfiguration,\<br>org.springframework.boot.autoconfigure.solr.SolrAutoConfiguration,\<br>org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration,\<br>org.springframework.boot.autoconfigure.task.TaskSchedulingAutoConfiguration,\<br>org.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration,\<br>org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration,\<br>org.springframework.boot.autoconfigure.transaction.jta.JtaAutoConfiguration,\<br>org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.embedded.EmbeddedWebServerFactoryCustomizerAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.reactive.HttpHandlerAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.reactive.ReactiveWebServerFactoryAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.reactive.WebFluxAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.reactive.error.ErrorWebFluxAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.reactive.function.client.ClientHttpConnectorAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.reactive.function.client.WebClientAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.servlet.MultipartAutoConfiguration,\<br>org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration,\<br>org.springframework.boot.autoconfigure.websocket.reactive.WebSocketReactiveAutoConfiguration,\<br>org.springframework.boot.autoconfigure.websocket.servlet.WebSocketServletAutoConfiguration,\<br>org.springframework.boot.autoconfigure.websocket.servlet.WebSocketMessagingAutoConfiguration,\<br>org.springframework.boot.autoconfigure.webservices.WebServicesAutoConfiguration,\<br>org.springframework.boot.autoconfigure.webservices.client.WebServiceTemplateAutoConfiguration<br></code></pre></td></tr></table></figure>



<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210224113220654.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210224113220654</span></p>
<h4 id="2-按需开启自动配置项"><a href="#2-按需开启自动配置项" class="headerlink" title="2.按需开启自动配置项"></a>2.按需开启自动配置项</h4><ol>
<li><p>虽然我们130个场景的所有自动配置启动的时候默认全部加载。</p>
</li>
<li><p>按照条件装配规则（@Conditional），最终会按需加载。</p>
<h4 id="3-修改默认配置"><a href="#3-修改默认配置" class="headerlink" title="3.修改默认配置"></a>3.修改默认配置</h4><p>SpringBoot默认会在底层配置好所有的组件。但是如果用户自己配置了以用户的优先。</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br>   <span class="hljs-meta">@ConditionalOnMissingBean</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> CharacterEncodingFilter <span class="hljs-title">characterEncodingFilter</span><span class="hljs-params">()</span> </span>&#123;<br></code></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li><p>SpringBoot先加载所有的自动配置类  xxxxAutoConfiguration</p>
</li>
<li><p>每个自动配置类按照条件进行生效，默认都会绑定配置文件指定的值。  xxxxProperties里面拿  ，xxxxproperties和配置文件进行了绑定</p>
</li>
<li><p>生效的配置类会给容器中装配很多组件</p>
</li>
<li><p>只要容器中有这些组件，相当于这些功能有了</p>
</li>
<li><p>只要用户有自己配置的，就以用户的优先</p>
</li>
<li><p>定制化配置</p>
<ul>
<li>用户直接自己@Bean替换底层的组件</li>
<li>用户去看这个组件是获取的配置文件什么值就去修改</li>
</ul>
<p>xxxxAutoConfiguration  —&gt;组件  —&gt;xxxxProperties里面拿值  —&gt;application.properties</p>
</li>
</ol>
<h4 id="4-最佳实践"><a href="#4-最佳实践" class="headerlink" title="4.最佳实践"></a>4.最佳实践</h4><ul>
<li><p>引入场景依赖</p>
<ul>
<li><a href="https://docs.spring.io/spring-boot/docs/2.4.3/reference/html/using-spring-boot.html#using-boot-starter" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/2.4.3/reference/html/using-spring-boot.html#using-boot-starter</a></li>
</ul>
</li>
<li><p>查看自动配置了哪些</p>
<ul>
<li>自己分析，引入场景对应的自动配置一般都生效了</li>
<li>配置文件中debug=true开启自动配置报告。Negative（不生效）\Positive（生效）</li>
</ul>
</li>
<li><p>是否需要修改</p>
<ul>
<li><p>参照文档修改配置项</p>
<ul>
<li><a href="https://docs.spring.io/spring-boot/docs/2.4.3/reference/html/appendix-application-properties.html#common-application-properties" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/2.4.3/reference/html/appendix-application-properties.html#common-application-properties</a></li>
<li>自己分析，xxxxproperties绑定了配置文件的哪些</li>
</ul>
</li>
<li><p>自定义加入或者替换组件</p>
<ul>
<li>@Bean、@Component。。。</li>
</ul>
</li>
<li><p>自定义器  xxxxCustomizer</p>
</li>
<li><p>……</p>
</li>
</ul>
</li>
</ul>
<h3 id="三、开发小技巧"><a href="#三、开发小技巧" class="headerlink" title="三、开发小技巧"></a>三、开发小技巧</h3><h4 id="1-Lombok"><a href="#1-Lombok" class="headerlink" title="1.Lombok"></a>1.Lombok</h4><p>​    简化JavaBean的开发,先导入依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>然后在Idea里下载Lombok插件就可以使用了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@NoArgsConstructor</span>  <span class="hljs-comment">//无参构造器</span><br><span class="hljs-meta">@AllArgsConstructor</span> <span class="hljs-comment">//全参构造器</span><br><span class="hljs-meta">@ToString</span>  <span class="hljs-comment">//重写tostring方法</span><br><span class="hljs-meta">@Data</span>  <span class="hljs-comment">//get set方法</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pet</span> </span>&#123;<br>    <span class="hljs-keyword">private</span>  String name;<br>&#125;<br><span class="hljs-comment">//Lombok还提供了@Slf4j日志注解 log.info("打印日志")</span><br></code></pre></td></tr></table></figure>

<p>2.dev-tools</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-devtools<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>Ctrl+F9</p>
<h3 id="四、配置文件"><a href="#四、配置文件" class="headerlink" title="四、配置文件"></a>四、配置文件</h3><h5 id="springboot使用一个全局的配置文件，配置文件名是固定的，有两种格式"><a href="#springboot使用一个全局的配置文件，配置文件名是固定的，有两种格式" class="headerlink" title="springboot使用一个全局的配置文件，配置文件名是固定的，有两种格式"></a>springboot使用一个全局的配置文件，配置文件名是固定的，有两种格式</h5><p>​        1.application.properties<br>​        2.application.yml<br>配置文件的作用：修改spring boot自动配置的默认值；spring boot在底层都给我们配置好的；</p>
<h4 id="yaml语法"><a href="#yaml语法" class="headerlink" title="yaml语法"></a>yaml语法</h4><h4 id="1-基本语法"><a href="#1-基本语法" class="headerlink" title="1.基本语法"></a>1.基本语法</h4><p>K:(空格)V : 表示一对键值对（空格必须有）；</p>
<p>以空格的缩进来控制层级关系；只有是左对齐的一列数据，都是一个层级的；属性和值也是大小写敏感的；</p>
<h4 id="2-值的写法"><a href="#2-值的写法" class="headerlink" title="2.值的写法"></a>2.值的写法</h4><h5 id="字面量：普通的值（数字，字符串，布尔）"><a href="#字面量：普通的值（数字，字符串，布尔）" class="headerlink" title="字面量：普通的值（数字，字符串，布尔）"></a>字面量：普通的值（数字，字符串，布尔）</h5><p>k: v : 字面直接来写；</p>
<p>​    字符串默认不用加上单引号或者双引号</p>
<p>“”：双引号； 不会转义字符串里面的特殊字符；特殊字符会作为本身想要表达的意思</p>
<p>name：”zhangsan \n lisi”：输出zhangsan 换行 lisi</p>
<p>‘’:单引号；会转义特殊字符，特殊字符最终只是一个普通的字符串数据</p>
<p>name：”zhangsan \n lisi”：输出zhangsan \n lisi</p>
<h5 id="对象、Map（属性和值）（键值对）："><a href="#对象、Map（属性和值）（键值对）：" class="headerlink" title="对象、Map（属性和值）（键值对）："></a>对象、Map（属性和值）（键值对）：</h5><p>k: v ：在下一行来写对象的属性和值的关系；注意缩进；对象还是k:v的方式</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">friends:</span><br>		<span class="hljs-attr">lastName:</span> <span class="hljs-string">zhangsan</span><br>		<span class="hljs-attr">age:</span> <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure>

<p>​    行内写法：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">friends:</span> <span class="hljs-string">&#123;lastName:</span> <span class="hljs-string">zhangsan,age:</span> <span class="hljs-number">18</span><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure>

<h5 id="数组（List-Set"><a href="#数组（List-Set" class="headerlink" title="数组（List,Set)"></a>数组（List,Set)</h5><p>用-值表示数组中的一个元素</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">pets:</span><br> <span class="hljs-bullet">-</span> <span class="hljs-string">cat</span><br> <span class="hljs-bullet">-</span> <span class="hljs-string">dog</span><br> <span class="hljs-bullet">-</span> <span class="hljs-string">pig</span><br></code></pre></td></tr></table></figure>

<p>行内写法 </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">pets:</span> <span class="hljs-string">[cat,dog,pig]</span><br></code></pre></td></tr></table></figure>

<h4 id="3-配置文件注入"><a href="#3-配置文件注入" class="headerlink" title="3.配置文件注入"></a>3.配置文件注入</h4><p>application.yml:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">person:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">张三</span><br>  <span class="hljs-attr">age:</span> <span class="hljs-number">18</span><br>  <span class="hljs-attr">isboy:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">birth:</span> <span class="hljs-number">2017</span><span class="hljs-string">/09/09</span><br>  <span class="hljs-attr">map:</span><br>    <span class="hljs-attr">k1:</span> <span class="hljs-string">v1</span><br>  <span class="hljs-attr">list:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">l1</span><br>  <span class="hljs-attr">dog:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">小狗</span><br>    <span class="hljs-attr">age:</span> <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>

<p>JavaBean：</p>
<p>@configurationProperties:将配置文件中的每一个属性值，映射到这个实体类中</p>
<p>prefix=”person” ： 将配置文件中person下面的所以属性进行一一映射</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@ConfigurationProperties</span>(prefix = <span class="hljs-string">"person"</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>    <span class="hljs-keyword">private</span>  String name;<br>    <span class="hljs-keyword">private</span>  Integer age;<br>    <span class="hljs-keyword">private</span> Boolean isboy;<br>     <span class="hljs-keyword">private</span> Date birth;<br><br>     <span class="hljs-keyword">private</span> Map&lt;String,Object&gt; map;<br>     <span class="hljs-keyword">private</span> List&lt;Object&gt; list;<br>    <span class="hljs-keyword">private</span>  Dog dog;<br></code></pre></td></tr></table></figure>

<p>配置文件处理器，以后编写配置就有提示</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>application.properties中文乱码问题</p>
<p>打开设置 进入 file encoding 更改Properties Files 的编码为UTF-8,并且勾上Transparent native-to-ascii conversation</p>
<h4 id="ConfigurationProperties和-value的区别"><a href="#ConfigurationProperties和-value的区别" class="headerlink" title="@ConfigurationProperties和@value的区别"></a>@ConfigurationProperties和@value的区别</h4><table>
<thead>
<tr>
<th></th>
<th>@ConfigurationProperties</th>
<th>@Value</th>
</tr>
</thead>
<tbody><tr>
<td>功能</td>
<td>批量注入配置文件中的属性</td>
<td>一个个值定</td>
</tr>
<tr>
<td>松散语法</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td>SpEL</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>JSR303数据检验</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td>复杂类型封装</td>
<td>支持</td>
<td>不支持</td>
</tr>
</tbody></table>
<p>配置文件yml还是properties他们都能获取到值</p>
<p>如果说，我们只是在某个业务逻辑中获取配置文件中的某项值，使用@Value</p>
<p>如果我们专门写了一个JavaBean来和配置文件进行映射，我们就直接使用ConfigurationProperties;</p>
<h4 id="3-配置文件数据检验"><a href="#3-配置文件数据检验" class="headerlink" title="3.配置文件数据检验"></a>3.配置文件数据检验</h4><p>@Validated</p>
<h4 id="4-PropertySource-ImportResource"><a href="#4-PropertySource-ImportResource" class="headerlink" title="4.@PropertySource/ImportResource"></a>4.@PropertySource/ImportResource</h4><p>@PropertySource:加载指定的配置文件；</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@PropertySource</span>(value=&#123;<span class="hljs-string">"classpath:person.properties"</span>&#125;)<br></code></pre></td></tr></table></figure>

<p> @ImportResource：导入Spring的配置文件，让配置文件里面的内容生效；</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ImportResource</span>(locations = <span class="hljs-string">"classpath:beans.xml"</span>)<br>导入spring配置文件使其生效<br></code></pre></td></tr></table></figure>



<p>SpringBoot推荐给容器中添加组件的方式；推荐使用全注解的方式</p>
<p>1.配置类======Spring配置文件</p>
<p>2.使用@Bean给容器中添加组件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">helloConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> HelloService <span class="hljs-title">helloService</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">"添加组件"</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> HelloService();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="5-配置文件占位符"><a href="#5-配置文件占位符" class="headerlink" title="5.配置文件占位符"></a>5.配置文件占位符</h4><p>1.随机数</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arduino">$&#123;<span class="hljs-built_in">random</span>.value&#125;,$&#123;<span class="hljs-built_in">random</span>.<span class="hljs-keyword">int</span>&#125;,$&#123;<span class="hljs-built_in">random</span>.<span class="hljs-keyword">long</span>&#125;<br>$&#123;<span class="hljs-built_in">random</span>.<span class="hljs-keyword">int</span>(<span class="hljs-number">10</span>)&#125;,$&#123;<span class="hljs-built_in">random</span>.<span class="hljs-keyword">int</span>[<span class="hljs-number">1024</span>,<span class="hljs-number">65536</span>]&#125;<br></code></pre></td></tr></table></figure>

<p>2.占位符获取之前配置的值，如果没有是可以用：指定默认值</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#person.name=张三$&#123;random.uuid&#125;</span><br><span class="hljs-meta">person.age</span>=<span class="hljs-string">$&#123;random.int&#125;</span><br><span class="hljs-meta">person.isboy</span>=<span class="hljs-string">false</span><br><span class="hljs-meta">person.birth</span>=<span class="hljs-string">2020/02/02</span><br><span class="hljs-meta">person.map.k1</span>=<span class="hljs-string">v1</span><br><span class="hljs-meta">person.list</span>=<span class="hljs-string">l1</span><br><span class="hljs-meta">person.dog.name</span>=<span class="hljs-string">$&#123;person.name:李四&#125;小狗</span><br><span class="hljs-meta">person.dog.age</span>=<span class="hljs-string">2</span><br></code></pre></td></tr></table></figure>

<h4 id="6-Profile"><a href="#6-Profile" class="headerlink" title="6.Profile"></a>6.Profile</h4><p>1.多Profile文件</p>
<p>我们在主配置文件编写的时候，文件名可以是application-{Profile}.properties/yml</p>
<p>默认使用application.properties的配置</p>
<p>2.yml支持多文档块方式</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span><br>    <span class="hljs-attr">active:</span> <span class="hljs-string">dev</span><br><span class="hljs-meta">---</span><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8081</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span> <span class="hljs-string">dev</span><br><span class="hljs-meta">---</span><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8082</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span> <span class="hljs-string">prod</span> <span class="hljs-comment">#指定属于哪个环境</span><br></code></pre></td></tr></table></figure>

<p>3.激活指定profile</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-meta">spring.profiles.active</span>=<span class="hljs-string">prod</span><br></code></pre></td></tr></table></figure>

<ul>
<li><p>@profile</p>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210306164059618.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210306164059618</span></p>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210306164012999.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210306164012999</span></p>
</li>
</ul>
<p>@Profile也可以标在配置类上，整个类只有在指定的生产环境下才能生效</p>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210306164211980.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210306164211980</span></p>
<p>命令行激活（可以修改配置文件任意值,以命令行优先）：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">java -jar project1-<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>-SNAPSHOT.jar --spring.profiles.active=prod --person.name=hello<br></code></pre></td></tr></table></figure>

<p>可以直接在测试的时候，配置传入命令行参数–spring.profiles.active=prod</p>
<p>虚拟机参数：</p>
<p>-Dspring.profiles.active=prod</p>
<p>7.配置文件加载位置</p>
<p> spring boot启动时会扫描以下位置的application.properties或者application.yml文件作为spring boot的默认配置文件</p>
<p>-file（项目文件）:/config/</p>
<p>-file:/</p>
<p>-classpath(resource):/config/</p>
<p>-classpath:/</p>
<p>优先级由高到低，高优先级的会覆盖低优先级的配置；</p>
<p>springboot会从这四个位置全部加载成主配置文件；互补配置</p>
<p>我们还可以通过spring.config.location来改变默认的配置文件位置</p>
<p>项目打包好以后，我们可以使用命令行参数的形式，启动项目的时候来指定配置文件的新位置；指定配置文件和默认的这些配置文件共同起作用形成互补配置；（springboot2.4.3实测没有互补）</p>
<h4 id="8-外部配置加载顺序"><a href="#8-外部配置加载顺序" class="headerlink" title="8.外部配置加载顺序"></a>8.外部配置加载顺序</h4><p>springboot也可以从以下位置加载配置；优先级从高到低；高优先级的配置覆盖低优先级的配置，所有的配置会形成互补配置</p>
<p>1.命令行参数</p>
<p>java -jar project4-0.0.1-SNAPSHOT.jar –server.port=8086 –server.servlet.context-path=/abc</p>
<p>多个配置用空格分开 –配置项=值</p>
<p>2.来自java：comp/env的JNDI属性</p>
<p>3.Java系统属性（System.getProperties()）</p>
<p>4.操作系统环境变量</p>
<p>5.RandomValuePropertySource配置的random.*属性值</p>
<p><strong>由jar包外向jar包内进行寻找；</strong></p>
<p><strong>优先加载带profile的</strong></p>
<p>6.jar包外部的application-{profiles}.properties或application.yml（带spring.profile）配置文件</p>
<p>7.jar包内部的application-{profiles}.properties或application.yml（带spring.profile）配置文件</p>
<p>8.jar包外部的application.properties或application.yml（不带spring.profile）配置文件</p>
<p>9.jar包内部的application.properties或application.yml（不带spring.profile）配置文件</p>
<p>10.@Configuration注解类上的@PropertySource</p>
<p>11.通过SpringApplication.setDefaultProperties指定的默认属性</p>
<p>所有支持的配置加载来源；</p>
<p>[参考官方文档](</p>
<h3 id="五、web开发（源码以后再看）"><a href="#五、web开发（源码以后再看）" class="headerlink" title="五、web开发（源码以后再看）"></a>五、web开发（源码以后再看）</h3><h4 id="1、SpringMVC自动配置概览"><a href="#1、SpringMVC自动配置概览" class="headerlink" title="1、SpringMVC自动配置概览"></a>1、SpringMVC自动配置概览</h4><p>Spring Boot provides auto-configuration for Spring MVC that <strong>works well with most applications.(大多场景我们都无需自定义配置)</strong></p>
<p>The auto-configuration adds the following features on top of Spring’s defaults:</p>
<ul>
<li><p>Inclusion of <code>ContentNegotiatingViewResolver</code> and <code>BeanNameViewResolver</code> beans.</p>
</li>
<li><ul>
<li>内容协商视图解析器和BeanName视图解析器</li>
</ul>
</li>
<li><p>Support for serving static resources, including support for WebJars (covered <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-spring-mvc-static-content" target="_blank" rel="noopener">later in this document</a>)).</p>
</li>
<li><ul>
<li>静态资源（包括webjars）</li>
</ul>
</li>
<li><p>Automatic registration of <code>Converter</code>, <code>GenericConverter</code>, and <code>Formatter</code> beans.</p>
</li>
<li><ul>
<li>自动注册 <code>Converter，GenericConverter，Formatter</code></li>
</ul>
</li>
<li><p>Support for <code>HttpMessageConverters</code> (covered <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-spring-mvc-message-converters" target="_blank" rel="noopener">later in this document</a>).</p>
</li>
<li><ul>
<li>支持 <code>HttpMessageConverters</code> （后来我们配合内容协商理解原理）</li>
</ul>
</li>
<li><p>Automatic registration of <code>MessageCodesResolver</code> (covered <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-spring-message-codes" target="_blank" rel="noopener">later in this document</a>).</p>
</li>
<li><ul>
<li>自动注册 <code>MessageCodesResolver</code> （国际化用）</li>
</ul>
</li>
<li><p>Static <code>index.html</code> support.</p>
</li>
<li><ul>
<li>静态index.html 页支持</li>
</ul>
</li>
<li><p>Custom <code>Favicon</code> support (covered <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-spring-mvc-favicon" target="_blank" rel="noopener">later in this document</a>).</p>
</li>
<li><ul>
<li>自定义 <code>Favicon</code>  </li>
</ul>
</li>
<li><p>Automatic use of a <code>ConfigurableWebBindingInitializer</code> bean (covered <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-spring-mvc-web-binding-initializer" target="_blank" rel="noopener">later in this document</a>).</p>
</li>
<li><ul>
<li>自动使用 <code>ConfigurableWebBindingInitializer</code> ，（DataBinder负责将请求数据绑定到JavaBean上）</li>
</ul>
</li>
</ul>
<blockquote>
<p>If you want to keep those Spring Boot MVC customizations and make more <a href="https://docs.spring.io/spring/docs/5.2.9.RELEASE/spring-framework-reference/web.html#mvc" target="_blank" rel="noopener">MVC customizations</a> (interceptors, formatters, view controllers, and other features), you can add your own <code>@Configuration</code> class of type <code>WebMvcConfigurer</code> but <strong>without</strong> <code>@EnableWebMvc</code>.</p>
<p><strong>不用@EnableWebMvc注解。使用</strong> <strong><code>@Configuration</code></strong> <strong>+</strong> <strong><code>WebMvcConfigurer</code></strong> <strong>自定义规则</strong></p>
</blockquote>
<blockquote>
<p>If you want to provide custom instances of <code>RequestMappingHandlerMapping</code>, <code>RequestMappingHandlerAdapter</code>, or <code>ExceptionHandlerExceptionResolver</code>, and still keep the Spring Boot MVC customizations, you can declare a bean of type <code>WebMvcRegistrations</code> and use it to provide custom instances of those components.</p>
<p><strong>声明</strong> <strong><code>WebMvcRegistrations</code></strong> <strong>改变默认底层组件</strong></p>
</blockquote>
<blockquote>
<p>If you want to take complete control of Spring MVC, you can add your own <code>@Configuration</code> annotated with <code>@EnableWebMvc</code>, or alternatively add your own <code>@Configuration</code>-annotated <code>DelegatingWebMvcConfiguration</code> as described in the Javadoc of <code>@EnableWebMvc</code>.</p>
<p><strong>使用</strong> <strong><code>@EnableWebMvc+@Configuration+DelegatingWebMvcConfiguration 全面接管SpringMVC</code></strong> </p>
</blockquote>
<h2 id="2-简单功能分析"><a href="#2-简单功能分析" class="headerlink" title="2.简单功能分析"></a>2.简单功能分析</h2><h3 id="2-1静态资源访问"><a href="#2-1静态资源访问" class="headerlink" title="2.1静态资源访问"></a>2.1静态资源访问</h3><h6 id="静态资源目录"><a href="#静态资源目录" class="headerlink" title="静态资源目录"></a>静态资源目录</h6><p>只要将静态资源放在类路径下： called <code>/static</code> (or <code>/public</code> or <code>/resources</code> or <code>/META-INF/resources</code></p>
<p>访问：当前项目根路径/+静态资源名</p>
<p>原理：静态映射/**。</p>
<p>请求进来，先去找Controller看能不能处理。不能处理的所有请求又都交给静态资源处理器。静态资源也找不到则响应404页面。</p>
<h5 id="静态资源访问前缀"><a href="#静态资源访问前缀" class="headerlink" title="静态资源访问前缀"></a>静态资源访问前缀</h5><p>默认无前缀</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">mvc:</span><br>    <span class="hljs-attr">static-path-pattern:</span> <span class="hljs-string">/res/**</span><br></code></pre></td></tr></table></figure>

<h5 id="webjar"><a href="#webjar" class="headerlink" title="webjar"></a>webjar</h5><p>自动映射 /<a href="http://localhost:8080/webjars/jquery/3.5.1/jquery.js" target="_blank" rel="noopener">webjars</a>/**</p>
<p><a href="https://www.webjars.org/" target="_blank" rel="noopener">https://www.webjars.org/</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.webjars<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jquery<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>访问地址：<a href="http://localhost:8080/webjars/jquery/3.5.1/jquery.js" target="_blank" rel="noopener">http://localhost:8080/webjars/<strong>jquery/3.5.1/jquery.js</strong></a>  后面地址要按照依赖里面的包路径</p>
<h3 id="2-2、欢迎页支持"><a href="#2-2、欢迎页支持" class="headerlink" title="2.2、欢迎页支持"></a>2.2、欢迎页支持</h3><h3 id="2-3、自定义-Favicon"><a href="#2-3、自定义-Favicon" class="headerlink" title="2.3、自定义 Favicon"></a>2.3、自定义 Favicon</h3><h3 id="2-4、静态资源配置原理"><a href="#2-4、静态资源配置原理" class="headerlink" title="2.4、静态资源配置原理"></a>2.4、静态资源配置原理</h3><p>25集</p>
<h2 id="3、请求参数处理"><a href="#3、请求参数处理" class="headerlink" title="3、请求参数处理"></a>3、请求参数处理</h2><h3 id="1、rest使用与原理"><a href="#1、rest使用与原理" class="headerlink" title="1、rest使用与原理"></a>1、rest使用与原理</h3><ul>
<li><p>@xxxMapping；</p>
</li>
<li><p>Rest风格支持（<em>使用*</em>HTTP*<em>请求方式动词来表示对资源的操作</em>）</p>
</li>
<li><ul>
<li><em>以前：**/getUser</em>  <em>获取用户</em>   <em>/deleteUser</em> <em>删除用户</em>   <em>/editUser</em>  <em>修改用户</em>    <em>/saveUser</em> <em>保存用户</em></li>
<li><em>现在： /user</em>   <em>GET-**获取用户</em>   <em>DELETE-**删除用户</em>   <em>PUT-**修改用户</em>    <em>POST-**保存用户</em></li>
<li>核心Filter；HiddenHttpMethodFilter</li>
</ul>
</li>
<li><ul>
<li><ul>
<li><p>用法： 表单method=post，隐藏域 _method=put</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;h1&gt;测试rest风格&lt;/h1&gt;&gt;<br>&lt;form action=<span class="hljs-string">"/user"</span> method=<span class="hljs-string">"get"</span> &gt;<br>    &lt;input type=<span class="hljs-string">"submit"</span> value=<span class="hljs-string">"GET"</span>&gt;<br>&lt;/form&gt;<br>&lt;form action=<span class="hljs-string">"/user"</span> method=<span class="hljs-string">"post"</span> &gt;<br>    &lt;input type=<span class="hljs-string">"submit"</span> value=<span class="hljs-string">"POST"</span>&gt;<br>&lt;/form&gt;<br>&lt;form action=<span class="hljs-string">"/user"</span> method=<span class="hljs-string">"post"</span> &gt;<br>    &lt;input name=<span class="hljs-string">"_method"</span> type=<span class="hljs-string">"hidden"</span> value=<span class="hljs-string">"PUT"</span>&gt;<br>    &lt;input type=<span class="hljs-string">"submit"</span> value=<span class="hljs-string">"PUT"</span>&gt;<br>&lt;/form&gt;<br>&lt;form action=<span class="hljs-string">"/user"</span> method=<span class="hljs-string">"post"</span> &gt;<br>    &lt;input name=<span class="hljs-string">"_method"</span> type=<span class="hljs-string">"hidden"</span> value=<span class="hljs-string">"DELETE"</span>&gt;<br>    &lt;input type=<span class="hljs-string">"submit"</span> value=<span class="hljs-string">"DELETE"</span>&gt;<br>&lt;/form&gt;<br>    <br>   <span class="hljs-comment">//controller:</span><br>  <span class="hljs-meta">@RequestMapping</span>(value = <span class="hljs-string">"/user"</span>,method = RequestMethod.GET)<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">get</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"GET"</span>;<br>    &#125;<br>    <span class="hljs-meta">@RequestMapping</span>(value = <span class="hljs-string">"/user"</span>,method = RequestMethod.POST)<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">post</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"POST"</span>;<br>    &#125;<br>    <span class="hljs-meta">@RequestMapping</span>(value = <span class="hljs-string">"/user"</span>,method = RequestMethod.PUT)<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">put</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"PUT"</span>;<br>    &#125;<br>    <span class="hljs-meta">@RequestMapping</span>(value = <span class="hljs-string">"/user"</span>,method = RequestMethod.DELETE)<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">delete</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"DELETE"</span>;<br>    &#125;<br></code></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>- SpringBoot中手动开启

  - ```yaml
    spring:
      mvc:
        hiddenmethod:
          filter:
            enabled: true
    <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs"><br>        <br><br>- - 扩展：如何把_method 这个名字换成我们自己喜欢的。<br><br><span class="hljs-attribute">REST原理：26集</span><br><span class="hljs-attribute"></span><br>### 2.请求映射原理<br><br><span class="hljs-attribute">28集</span><br><span class="hljs-attribute"></span><br>## 2、普通参数与基本注解<br><br>### 1.1、注解：<br><br>@PathVariable(路径变量)、@RequestHeader(获取请求头)、@ModelAttribute()、@RequestParam(获取请求参数)、@MatrixVariable(矩阵变量)31集，@CookieValue(获取cookie值)、@RequestBody(获取请求体[post])、@RequestAttribute(获取request域属性)<br><br>### 1.2、Servlet API：<br><br>WebRequest、ServletRequest、MultipartRequest、 HttpSession、javax.servlet.http.PushBuilder、Principal、InputStream、Reader、HttpMethod、Locale、TimeZone、ZoneId<br><br>### 1.3、复杂参数：<br><br>**Map**、**Model（map、model里面的数据会被放在request的请求域  request.setAttribute）、**Errors/BindingResult、**RedirectAttributes（ 重定向携带数据）**、**ServletResponse（response）**、SessionStatus、UriComponentsBuilder、ServletUriComponentsBuilder<br><br>### 3.thymeleaf<br><br>### 4.拦截器<br><br>```java<br>public class LoginInterceptor implements HandlerInterceptor &#123;<br>    @Override<br>    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123;<br>        HttpSession session = request.getSession();<br>        if(session.getAttribute("user") != null)&#123;<br>            return true;<br>        &#125;<br>        return false;<br>    &#125;<br></code></pre></td></tr></table></figure></code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebMvcConfigurer</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> </span>&#123;<br>        registry.addInterceptor(<span class="hljs-keyword">new</span> LoginInterceptor()).addPathPatterns(<span class="hljs-string">"/**"</span>).excludePathPatterns(<span class="hljs-string">"/login.html"</span>,<span class="hljs-string">"/loginUser"</span>);<br>    &#125;<br></code></pre></td></tr></table></figure>

<h3 id="5-文件上传"><a href="#5-文件上传" class="headerlink" title="5.文件上传"></a>5.文件上传</h3><h3 id="6-异常处理"><a href="#6-异常处理" class="headerlink" title="6.异常处理"></a>6.异常处理</h3><h3 id="7-Web原生组件注入（servlet，Filter，Listener）"><a href="#7-Web原生组件注入（servlet，Filter，Listener）" class="headerlink" title="7.Web原生组件注入（servlet，Filter，Listener）"></a>7.Web原生组件注入（servlet，Filter，Listener）</h3><h2 id="六、数据访问"><a href="#六、数据访问" class="headerlink" title="六、数据访问"></a>六、数据访问</h2><h3 id="1-整合druid数据源"><a href="#1-整合druid数据源" class="headerlink" title="1.整合druid数据源"></a>1.整合druid数据源</h3><h4 id="1-1自定义方式"><a href="#1-1自定义方式" class="headerlink" title="1.1自定义方式"></a>1.1自定义方式</h4><h4 id="1-2使用官方starter方式"><a href="#1-2使用官方starter方式" class="headerlink" title="1.2使用官方starter方式"></a>1.2使用官方starter方式</h4><h3 id="2-整合Mybatis"><a href="#2-整合Mybatis" class="headerlink" title="2.整合Mybatis"></a>2.整合Mybatis</h3><h4 id="2-1、配置模式"><a href="#2-1、配置模式" class="headerlink" title="2.1、配置模式"></a>2.1、配置模式</h4><ol>
<li>导入mybatis-starter</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol start="2">
<li>创建全局配置文件和mapper映射文件</li>
</ol>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210302171737923.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210302171737923</span></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br><br>#全局配置文件<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">"org.mybatis.example.BlogMapper"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"selectBlog"</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">"Blog"</span>&gt;</span><br>    select * from Blog where id = #&#123;id&#125;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br><br>#mapper映射文件<br></code></pre></td></tr></table></figure>

<ol start="3">
<li><p>在yaml配置文件中配置mybatis规则</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">mybatis:</span><br>  <span class="hljs-attr">config-location:</span> <span class="hljs-string">classpath:mybatis/mybatis-config.xml</span> <span class="hljs-comment">#mybatis全局配置文件位置</span><br>  <span class="hljs-attr">mapper-locations:</span> <span class="hljs-string">classpath:mybatis/mapper/*.xml</span> <span class="hljs-comment">#mapper配置文件位置</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>编写mapper接口和service业务类</p>
</li>
</ol>
<h3 id="3、整合Mybatis-Plus"><a href="#3、整合Mybatis-Plus" class="headerlink" title="3、整合Mybatis-Plus"></a>3、整合Mybatis-Plus</h3><ol>
<li><p>引入Mybatis-Plus依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>Latest Version<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>



</li>
</ol>
<ol start="2">
<li><p>配置数据库相关的配置</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#datasource的父级是spring</span><br><span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/book</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>在 Spring Boot 启动类中添加 <code>@MapperScan</code> 注解，扫描 Mapper 文件夹：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@MapperScan</span>(<span class="hljs-string">"com.project.project6.mapper"</span>)<br></code></pre></td></tr></table></figure>
</li>
<li><p>编写实体类，mapper接口，以及业务逻辑层</p>
<ul>
<li>实体类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-meta">@TableField</span>(exist = <span class="hljs-keyword">false</span>) <span class="hljs-comment">//代表表中不存在的字段</span><br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-meta">@TableField</span>(exist = <span class="hljs-keyword">false</span>)<br>    <span class="hljs-keyword">private</span>  String password;<br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> String email;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li><p>mapper接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseMapper</span>&lt;<span class="hljs-title">User</span>&gt; </span>&#123;<br>&#125;  <span class="hljs-comment">//继承Mybatis-Plus提供的BaseMapper接口。</span><br></code></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ol>
<ul>
<li><p>业务逻辑层</p>
<h6 id="service"><a href="#service" class="headerlink" title="service"></a>service</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">IService</span>&lt;<span class="hljs-title">User</span>&gt; </span>&#123;<br>&#125;  <span class="hljs-comment">//继承Mybatis-Plus提供的IService接口。</span><br></code></pre></td></tr></table></figure>

<h6 id="serviceImpl"><a href="#serviceImpl" class="headerlink" title="serviceImpl"></a>serviceImpl</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ServiceImpl</span>&lt;<span class="hljs-title">UserMapper</span>,<span class="hljs-title">User</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">UserService</span> </span>&#123;<br>&#125;  <span class="hljs-comment">//继承Mybatis-Plus提供的ServiceImpl接口。</span><br></code></pre></td></tr></table></figure>

</li>
</ul>
<ol start="5">
<li><p>分页使用</p>
<ul>
<li>导入分页插件</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MybatisPlusConfig</span> </span>&#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> MybatisPlusInterceptor <span class="hljs-title">mybatisPlusInterceptor</span><span class="hljs-params">()</span> </span>&#123;<br>        MybatisPlusInterceptor interceptor = <span class="hljs-keyword">new</span> MybatisPlusInterceptor();<br>        interceptor.addInnerInterceptor(<span class="hljs-keyword">new</span> PaginationInnerInterceptor(DbType.MYSQL));<br>        <span class="hljs-keyword">return</span> interceptor;<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ConfigurationCustomizer <span class="hljs-title">configurationCustomizer</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> configuration -&gt; configuration.setUseDeprecatedExecutor(<span class="hljs-keyword">false</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



</li>
</ol>
<ul>
<li><p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/user"</span>)<br>    <span class="hljs-function"><span class="hljs-keyword">public</span>  Object <span class="hljs-title">getUser</span><span class="hljs-params">(@RequestParam(value = <span class="hljs-string">"pn"</span>,defaultValue = <span class="hljs-string">"1"</span>)</span>Integer pn)</span>&#123;<br>        Page&lt;User&gt; page = <span class="hljs-keyword">new</span> Page&lt;User&gt;(pn,<span class="hljs-number">2</span>);<br>      <span class="hljs-keyword">return</span> userService.page(page);<br>    &#125;<br></code></pre></td></tr></table></figure>


</li>
</ul>
<h3 id="4-整合Redis"><a href="#4-整合Redis" class="headerlink" title="4.整合Redis"></a>4.整合Redis</h3><ol>
<li><p>导入依赖并编写配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  //redis依赖<br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>redis.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jedis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> //jedis依赖<br></code></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">redis:</span><br>    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>  <span class="hljs-string">//redis地址</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span>  <span class="hljs-string">//密码</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>  <span class="hljs-string">//端口号</span><br>    <span class="hljs-attr">client-type:</span> <span class="hljs-string">jedis</span>  <span class="hljs-string">//工厂类型</span><br></code></pre></td></tr></table></figure>



</li>
</ol>
<ol start="2">
<li><p>注入StringRedisTemplate组件来操作redis</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br>    StringRedisTemplate stringRedisTemplate;<br><span class="hljs-meta">@Autowired</span><br>    RedisConnectionFactory redisConnectionFactory;  <span class="hljs-comment">//查看当前连接工厂</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>调用opsForValue方法来进行操作</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br>   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> </span>&#123;<br>       ValueOperations&lt;String, String&gt; operations = stringRedisTemplate.opsForValue();<br>       operations.set(<span class="hljs-string">"hello"</span>,<span class="hljs-string">"world"</span>);<br>       operations.get(<span class="hljs-string">"hello"</span>);<br>       System.out.println(redisConnectionFactory.getClass()); <span class="hljs-comment">//使用jedis连接工厂</span><br>   &#125;<br></code></pre></td></tr></table></figure>

<h4 id="2-使用redis实现统计功能"><a href="#2-使用redis实现统计功能" class="headerlink" title="2.使用redis实现统计功能"></a>2.使用redis实现统计功能</h4><ul>
<li>编写一个拦截器，请求一次就统计一次</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedisConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    StringRedisTemplate stringRedisTemplate;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        String uri = request.getRequestURI();<br>        ValueOperations&lt;String, String&gt; operations = stringRedisTemplate.opsForValue();<br>        operations.increment(uri); <span class="hljs-comment">//默认每次访问uri就会+1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebMvcConfigurer</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    RedisConfig redisConfig;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> </span>&#123;<br>        registry.addInterceptor(<span class="hljs-keyword">new</span> LoginInterceptor())<br>                .addPathPatterns(<span class="hljs-string">"/**"</span>).excludePathPatterns(<span class="hljs-string">"/login.html"</span>,<span class="hljs-string">"/loginUser"</span>);<br>        registry.addInterceptor(redisConfig).addPathPatterns(<span class="hljs-string">"/**"</span>).excludePathPatterns(<span class="hljs-string">"/login.html"</span>,<span class="hljs-string">"/loginUser"</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li><p>controller测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br>   StringRedisTemplate stringRedisTemplate;<br>   <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"main.html"</span>)<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">totle</span><span class="hljs-params">(Model model)</span></span>&#123;<br>       ValueOperations&lt;String, String&gt; operations = stringRedisTemplate.opsForValue();<br>      String cat =  operations.get(<span class="hljs-string">"/cat"</span>);<br>       String city = operations.get(<span class="hljs-string">"/city"</span>);<br>       model.addAttribute(<span class="hljs-string">"cat"</span>,cat);<br>       model.addAttribute(<span class="hljs-string">"city"</span>,city);<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">"index.html"</span>;<br>   &#125;<br></code></pre></td></tr></table></figure>

<h2 id="七、单元测试"><a href="#七、单元测试" class="headerlink" title="七、单元测试"></a>七、单元测试</h2><h3 id="1、JUnit5-的变化"><a href="#1、JUnit5-的变化" class="headerlink" title="1、JUnit5 的变化"></a>1、JUnit5 的变化</h3><p><strong>Spring Boot 2.2.0 版本开始引入 JUnit 5 作为单元测试默认库</strong></p>
<p>作为最新版本的JUnit框架，JUnit5与之前版本的Junit框架有很大的不同。由三个不同子项目的几个不同模块组成。</p>
<blockquote>
<p><strong>JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage</strong></p>
</blockquote>
<p><strong>JUnit Platform</strong>: Junit Platform是在JVM上启动测试框架的基础，不仅支持Junit自制的测试引擎，其他测试引擎也都可以接入。</p>
<p><strong>JUnit Jupiter</strong>: JUnit Jupiter提供了JUnit5的新的编程模型，是JUnit5新特性的核心。内部 包含了一个<strong>测试引擎</strong>，用于在Junit Platform上运行。</p>
<p><strong>JUnit Vintage</strong>: 由于JUint已经发展多年，为了照顾老的项目，JUnit Vintage提供了兼容JUnit4.x,Junit3.x的测试引擎。</p>
<p><img    class="lazyload" data-original="https://cdn.nlark.com/yuque/0/2020/png/1354552/1606796395719-eb57ab48-ae44-45e5-8d2e-c4d507aff49a.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image</span></p>
<p>注意：</p>
<p><strong>SpringBoot 2.4 以上版本移除了默认对 Vintage 的依赖。如果需要兼容junit4需要自行引入（不能使用junit4的功能 @Test）</strong></p>
<p><strong>JUnit 5’s Vintage Engine Removed from</strong> <strong><code>spring-boot-starter-test,如果需要继续兼容junit4需要自行引入vintage</code></strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.vintage<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-vintage-engine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hamcrest<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hamcrest-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>**<br>**</p>
</li>
</ul>
<p>  <img    class="lazyload" data-original="https://cdn.nlark.com/yuque/0/2020/png/1354552/1606797616337-e73010e9-9cac-496d-a177-64b677af5a3d.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_10%2Ctext_YXRndWlndS5jb20g5bCa56GF6LC3%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image.png</span></p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>  现在版本：</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Boot05WebAdminApplicationTests</span> </span>&#123;<br><br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> </span>&#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>





<p>  以前：</p>
<p>  @SpringBootTest + @RunWith(SpringTest.class)</p>
<p>  SpringBoot整合Junit以后。</p>
<ul>
<li>编写测试方法：@Test标注（注意需要使用junit5版本的注解）</li>
<li>Junit类具有Spring的功能，@Autowired、比如 @Transactional 标注测试方法，测试完成后自动回滚</li>
</ul>
<h3 id="2、JUnit5常用注解"><a href="#2、JUnit5常用注解" class="headerlink" title="2、JUnit5常用注解"></a>2、JUnit5常用注解</h3><p>  JUnit5的注解与JUnit4的注解有所变化</p>
<p>  <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-annotations" target="_blank" rel="noopener">https://junit.org/junit5/docs/current/user-guide/#writing-tests-annotations</a></p>
<ul>
<li><p><strong>@Test :</strong>表示方法是测试方法。但是与JUnit4的@Test不同，他的职责非常单一不能声明任何属性，拓展的测试将会由Jupiter提供额外测试</p>
</li>
<li><p><strong>@ParameterizedTest :</strong>表示方法是参数化测试，下方会有详细介绍</p>
</li>
<li><p><strong>@RepeatedTest :</strong>表示方法可重复执行，下方会有详细介绍</p>
</li>
<li><p><strong>@DisplayName :</strong>为测试类或者测试方法设置展示名称</p>
</li>
<li><p><strong>@BeforeEach :</strong>表示在每个单元测试之前执行</p>
</li>
<li><p><strong>@AfterEach :</strong>表示在每个单元测试之后执行</p>
</li>
<li><p><strong>@BeforeAll :</strong>表示在所有单元测试之前执行</p>
</li>
<li><p><strong>@AfterAll :</strong>表示在所有单元测试之后执行</p>
</li>
<li><p><strong>@Tag :</strong>表示单元测试类别，类似于JUnit4中的@Categories</p>
</li>
<li><p><strong>@Disabled :</strong>表示测试类或测试方法不执行，类似于JUnit4中的@Ignore</p>
</li>
<li><p><strong>@Timeout :</strong>表示测试方法运行如果超过了指定时间将会返回错误</p>
</li>
<li><p><strong>@ExtendWith :</strong>为测试类或测试方法提供扩展类引用</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.junit</span><span class="hljs-selector-class">.jupiter</span><span class="hljs-selector-class">.api</span><span class="hljs-selector-class">.Test</span>; <span class="hljs-comment">//注意这里使用的是jupiter的Test注解！！</span><br><br><br><span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">TestDemo</span> &#123;<br><br>  <span class="hljs-variable">@Test</span><br>  <span class="hljs-variable">@DisplayName</span>(<span class="hljs-string">"第一次测试"</span>)<br>  public void firstTest() &#123;<br>      <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"hello world"</span>);<br>  &#125;<br></code></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="3、断言（assertions）"><a href="#3、断言（assertions）" class="headerlink" title="3、断言（assertions）"></a>3、断言（assertions）</h3><p>  断言（assertions）是测试方法中的核心部分，用来对测试需要满足的条件进行验证。<strong>这些断言方法都是 org.junit.jupiter.api.Assertions 的静态方法</strong>。JUnit 5 内置的断言可以分成如下几个类别：</p>
<p>  <strong>检查业务逻辑返回的数据是否合理。</strong></p>
<p>  <strong>所有的测试运行结束以后，会有一个详细的测试报告；</strong></p>
<h4 id="1、简单断言"><a href="#1、简单断言" class="headerlink" title="1、简单断言"></a>1、简单断言</h4><p>  用来对单个值进行简单的验证。如：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>assertEquals</td>
<td>判断两个对象或两个原始类型是否相等</td>
</tr>
<tr>
<td>assertNotEquals</td>
<td>判断两个对象或两个原始类型是否不相等</td>
</tr>
<tr>
<td>assertSame</td>
<td>判断两个对象引用是否指向同一个对象</td>
</tr>
<tr>
<td>assertNotSame</td>
<td>判断两个对象引用是否指向不同的对象</td>
</tr>
<tr>
<td>assertTrue</td>
<td>判断给定的布尔值是否为 true</td>
</tr>
<tr>
<td>assertFalse</td>
<td>判断给定的布尔值是否为 false</td>
</tr>
<tr>
<td>assertNull</td>
<td>判断给定的对象引用是否为 null</td>
</tr>
<tr>
<td>assertNotNull</td>
<td>判断给定的对象引用是否不为 null</td>
</tr>
</tbody></table>
  <figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">@Test<br>@<span class="hljs-constructor">DisplayName(<span class="hljs-string">"simple assertion"</span>)</span><br>public void simple<span class="hljs-literal">()</span> &#123;<br>     <span class="hljs-keyword">assert</span><span class="hljs-constructor">Equals(3, 1 + 2, <span class="hljs-string">"simple math"</span>)</span>;<br>     <span class="hljs-keyword">assert</span><span class="hljs-constructor">NotEquals(3, 1 + 1)</span>;<br><br>     <span class="hljs-keyword">assert</span><span class="hljs-constructor">NotSame(<span class="hljs-params">new</span> Object()</span>, <span class="hljs-keyword">new</span> <span class="hljs-constructor">Object()</span>);<br>     Object obj = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Object()</span>;<br>     <span class="hljs-keyword">assert</span><span class="hljs-constructor">Same(<span class="hljs-params">obj</span>, <span class="hljs-params">obj</span>)</span>;<br><br>     <span class="hljs-keyword">assert</span><span class="hljs-constructor">False(1 &gt; 2)</span>;<br>     <span class="hljs-keyword">assert</span><span class="hljs-constructor">True(1 &lt; 2)</span>;<br><br>     <span class="hljs-keyword">assert</span><span class="hljs-constructor">Null(<span class="hljs-params">null</span>)</span>;<br>     <span class="hljs-keyword">assert</span><span class="hljs-constructor">NotNull(<span class="hljs-params">new</span> Object()</span>);<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="2、数组断言"><a href="#2、数组断言" class="headerlink" title="2、数组断言"></a>2、数组断言</h3><p>  通过 assertArrayEquals 方法来判断两个对象或原始类型的数组是否相等</p>
  <figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Test</span><br><span class="hljs-variable">@DisplayName</span>(<span class="hljs-string">"array assertion"</span>)<br>public void array() &#123;<br> <span class="hljs-selector-tag">assertArrayEquals</span>(new int[]&#123;<span class="hljs-selector-tag">1</span>, <span class="hljs-selector-tag">2</span>&#125;, <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">int</span><span class="hljs-selector-attr">[]</span> &#123;<span class="hljs-selector-tag">1</span>, <span class="hljs-selector-tag">2</span>&#125;);<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="3、组合断言"><a href="#3、组合断言" class="headerlink" title="3、组合断言"></a>3、组合断言</h3><p>  assertAll 方法接受多个 org.junit.jupiter.api.Executable 函数式接口的实例作为要验证的断言，可以通过 lambda 表达式很容易的提供这些断言</p>
  <figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Test</span><br><span class="hljs-variable">@DisplayName</span>(<span class="hljs-string">"assert all"</span>)<br>public void all() &#123;<br> <span class="hljs-selector-tag">assertAll</span>(<span class="hljs-string">"Math"</span>,<br>    () -&gt; assertEquals(<span class="hljs-number">2</span>, <span class="hljs-number">1</span> + <span class="hljs-number">1</span>),<br>    () -&gt; assertTrue(<span class="hljs-number">1</span> &gt; <span class="hljs-number">0</span>)<br> );<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="4、异常断言"><a href="#4、异常断言" class="headerlink" title="4、异常断言"></a>4、异常断言</h3><p>  在JUnit4时期，想要测试方法的异常情况时，需要用<strong>@Rule</strong>注解的ExpectedException变量还是比较麻烦的。而JUnit5提供了一种新的断言方式<strong>Assertions.assertThrows()</strong> ,配合函数式编程就可以进行使用。</p>
  <figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@Test</span><br><span class="hljs-meta">@DisplayName(<span class="hljs-meta-string">"异常测试"</span>)</span><br><span class="hljs-keyword">public</span> void exceptionTest() &#123;<br>    ArithmeticException exception = Assertions.assertThrows(<br>           <span class="hljs-comment">//扔出断言异常</span><br>            ArithmeticException<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-type"></span></span>() -&gt; System.<span class="hljs-keyword">out</span>.println(<span class="hljs-number">1</span> % <span class="hljs-number">0</span>));<br><br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="5、超时断言"><a href="#5、超时断言" class="headerlink" title="5、超时断言"></a>5、超时断言</h3><p>  Junit5还提供了<strong>Assertions.assertTimeout()</strong> 为测试方法设置了超时时间</p>
  <figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Test</span><br><span class="hljs-variable">@DisplayName</span>(<span class="hljs-string">"超时测试"</span>)<br>public void timeoutTest() &#123;<br>    <span class="hljs-comment">//如果测试方法时间超过1s将会异常</span><br>    <span class="hljs-selector-tag">Assertions</span><span class="hljs-selector-class">.assertTimeout</span>(Duration.ofMillis(<span class="hljs-number">1000</span>), () -&gt; Thread.sleep(<span class="hljs-number">500</span>));<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="6、快速失败"><a href="#6、快速失败" class="headerlink" title="6、快速失败"></a>6、快速失败</h3><p>  通过 fail 方法直接使得测试失败</p>
  <figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Test</span><br><span class="hljs-variable">@DisplayName</span>(<span class="hljs-string">"fail"</span>)<br>public void shouldFail() &#123;<br> <span class="hljs-selector-tag">fail</span>(<span class="hljs-string">"This should fail"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="4、前置条件（assumptions）"><a href="#4、前置条件（assumptions）" class="headerlink" title="4、前置条件（assumptions）"></a>4、前置条件（assumptions）</h3><p>JUnit 5 中的前置条件（<strong>assumptions【假设】</strong>）类似于断言，不同之处在于<strong>不满足的断言会使得测试方法失败</strong>，而不满足的<strong>前置条件只会使得测试方法的执行终止</strong>。前置条件可以看成是测试方法执行的前提，当该前提不满足时，就没有继续执行的必要。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@DisplayName(<span class="hljs-meta-string">"前置条件"</span>)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AssumptionsTest</span> </span>&#123;<br> <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String environment = <span class="hljs-string">"DEV"</span>;<br> <br> <span class="hljs-meta">@Test</span><br> <span class="hljs-meta">@DisplayName(<span class="hljs-meta-string">"simple"</span>)</span><br> <span class="hljs-keyword">public</span> void simpleAssume() &#123;<br>    assumeTrue(Objects.equals(<span class="hljs-keyword">this</span>.environment, <span class="hljs-string">"DEV"</span>));<br>    assumeFalse(() -&gt; Objects.equals(<span class="hljs-keyword">this</span>.environment, <span class="hljs-string">"PROD"</span>));<br> &#125;<br> <br> <span class="hljs-meta">@Test</span><br> <span class="hljs-meta">@DisplayName(<span class="hljs-meta-string">"assume then do"</span>)</span><br> <span class="hljs-keyword">public</span> void assumeThenDo() &#123;<br>    assumingThat(<br>       Objects.equals(<span class="hljs-keyword">this</span>.environment, <span class="hljs-string">"DEV"</span>),<br>       () -&gt; System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"In DEV"</span>)<br>    );<br> &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>assumeTrue 和 assumFalse 确保给定的条件为 true 或 false，不满足条件会使得测试执行终止。assumingThat 的参数是表示条件的布尔值和对应的 Executable 接口的实现对象。只有条件满足时，Executable 对象才会被执行；当条件不满足时，测试执行并不会终止。</p>
<h3 id="5、嵌套测试"><a href="#5、嵌套测试" class="headerlink" title="5、嵌套测试"></a>5、嵌套测试</h3><p>JUnit 5 可以通过 Java 中的内部类和@Nested 注解实现嵌套测试，从而可以更好的把相关的测试方法组织在一起。在内部类中可以使用@BeforeEach 和@AfterEach 注解，而且嵌套的层次没有限制。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">@<span class="hljs-constructor">DisplayName(<span class="hljs-string">"A stack"</span>)</span><br><span class="hljs-keyword">class</span> TestingAStackDemo &#123;<br><br>    Stack&lt;Object&gt; stack;<br><br>    @Test<br>    @<span class="hljs-constructor">DisplayName(<span class="hljs-string">"is instantiated with new Stack()"</span>)</span><br>    void is<span class="hljs-constructor">InstantiatedWithNew()</span> &#123;<br>        <span class="hljs-keyword">new</span> Stack&lt;&gt;<span class="hljs-literal">()</span>;<br>    &#125;<br><br>    @Nested<br>    @<span class="hljs-constructor">DisplayName(<span class="hljs-string">"when new"</span>)</span><br>    <span class="hljs-keyword">class</span> WhenNew &#123;<br><br>        @BeforeEach<br>        void create<span class="hljs-constructor">NewStack()</span> &#123;<br>            stack = <span class="hljs-keyword">new</span> Stack&lt;&gt;<span class="hljs-literal">()</span>;<br>        &#125;<br><br>        @Test<br>        @<span class="hljs-constructor">DisplayName(<span class="hljs-string">"is empty"</span>)</span><br>        void is<span class="hljs-constructor">Empty()</span> &#123;<br>            <span class="hljs-keyword">assert</span><span class="hljs-constructor">True(<span class="hljs-params">stack</span>.<span class="hljs-params">isEmpty</span>()</span>);<br>        &#125;<br><br>        @Test<br>        @<span class="hljs-constructor">DisplayName(<span class="hljs-string">"throws EmptyStackException when popped"</span>)</span><br>        void throws<span class="hljs-constructor">ExceptionWhenPopped()</span> &#123;<br>            <span class="hljs-keyword">assert</span><span class="hljs-constructor">Throws(EmptyStackException.<span class="hljs-params">class</span>, <span class="hljs-params">stack</span>::<span class="hljs-params">pop</span>)</span>;<br>        &#125;<br><br>        @Test<br>        @<span class="hljs-constructor">DisplayName(<span class="hljs-string">"throws EmptyStackException when peeked"</span>)</span><br>        void throws<span class="hljs-constructor">ExceptionWhenPeeked()</span> &#123;<br>            <span class="hljs-keyword">assert</span><span class="hljs-constructor">Throws(EmptyStackException.<span class="hljs-params">class</span>, <span class="hljs-params">stack</span>::<span class="hljs-params">peek</span>)</span>;<br>        &#125;<br><br>        @Nested<br>        @<span class="hljs-constructor">DisplayName(<span class="hljs-string">"after pushing an element"</span>)</span><br>        <span class="hljs-keyword">class</span> AfterPushing &#123;<br><br>            String anElement = <span class="hljs-string">"an element"</span>;<br><br>            @BeforeEach<br>            void push<span class="hljs-constructor">AnElement()</span> &#123;<br>                stack.push(anElement);<br>            &#125;<br><br>            @Test<br>            @<span class="hljs-constructor">DisplayName(<span class="hljs-string">"it is no longer empty"</span>)</span><br>            void is<span class="hljs-constructor">NotEmpty()</span> &#123;<br>                <span class="hljs-keyword">assert</span><span class="hljs-constructor">False(<span class="hljs-params">stack</span>.<span class="hljs-params">isEmpty</span>()</span>);<br>            &#125;<br><br>            @Test<br>            @<span class="hljs-constructor">DisplayName(<span class="hljs-string">"returns the element when popped and is empty"</span>)</span><br>            void return<span class="hljs-constructor">ElementWhenPopped()</span> &#123;<br>                <span class="hljs-keyword">assert</span><span class="hljs-constructor">Equals(<span class="hljs-params">anElement</span>, <span class="hljs-params">stack</span>.<span class="hljs-params">pop</span>()</span>);<br>                <span class="hljs-keyword">assert</span><span class="hljs-constructor">True(<span class="hljs-params">stack</span>.<span class="hljs-params">isEmpty</span>()</span>);<br>            &#125;<br><br>            @Test<br>            @<span class="hljs-constructor">DisplayName(<span class="hljs-string">"returns the element when peeked but remains not empty"</span>)</span><br>            void return<span class="hljs-constructor">ElementWhenPeeked()</span> &#123;<br>                <span class="hljs-keyword">assert</span><span class="hljs-constructor">Equals(<span class="hljs-params">anElement</span>, <span class="hljs-params">stack</span>.<span class="hljs-params">peek</span>()</span>);<br>                <span class="hljs-keyword">assert</span><span class="hljs-constructor">False(<span class="hljs-params">stack</span>.<span class="hljs-params">isEmpty</span>()</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="6、参数化测试"><a href="#6、参数化测试" class="headerlink" title="6、参数化测试"></a>6、参数化测试</h3><p>参数化测试是JUnit5很重要的一个新特性，它使得用不同的参数多次运行测试成为了可能，也为我们的单元测试带来许多便利。</p>
<p>利用<strong>@ValueSource</strong>等注解，指定入参，我们将可以使用不同的参数进行多次单元测试，而不需要每新增一个参数就新增一个单元测试，省去了很多冗余代码。</p>
<p>**<br>**</p>
<p><strong>@ValueSource</strong>: 为参数化测试指定入参来源，支持八大基础类以及String类型,Class类型</p>
<p><strong>@NullSource</strong>: 表示为参数化测试提供一个null的入参</p>
<p><strong>@EnumSource</strong>: 表示为参数化测试提供一个枚举入参</p>
<p><strong>@CsvFileSource</strong>：表示读取指定CSV文件内容作为参数化测试入参</p>
<p><strong>@MethodSource</strong>：表示读取指定方法的返回值作为参数化测试入参(注意方法返回需要是一个流)</p>
<blockquote>
<p>当然如果参数化测试仅仅只能做到指定普通的入参还达不到让我觉得惊艳的地步。让我真正感到他的强大之处的地方在于他可以支持外部的各类入参。如:CSV,YML,JSON 文件甚至方法的返回值也可以作为入参。只需要去实现<strong>ArgumentsProvider</strong>接口，任何外部文件都可以作为它的入参。</p>
</blockquote>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">@ParameterizedTest<br>@<span class="hljs-constructor">ValueSource(<span class="hljs-params">strings</span> = &#123;<span class="hljs-string">"one"</span>, <span class="hljs-string">"two"</span>, <span class="hljs-string">"three"</span>&#125;)</span><br>@<span class="hljs-constructor">DisplayName(<span class="hljs-string">"参数化测试1"</span>)</span><br>public void parameterized<span class="hljs-constructor">Test1(String <span class="hljs-params">string</span>)</span> &#123;<br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(<span class="hljs-built_in">string</span>);<br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Assertions</span>.</span></span><span class="hljs-keyword">assert</span><span class="hljs-constructor">True(StringUtils.<span class="hljs-params">isNotBlank</span>(<span class="hljs-params">string</span>)</span>);<br>&#125;<br><br><br>@ParameterizedTest<br>@<span class="hljs-constructor">MethodSource(<span class="hljs-string">"method"</span>)</span>    <span class="hljs-comment">//指定方法名</span><br>@<span class="hljs-constructor">DisplayName(<span class="hljs-string">"方法来源参数"</span>)</span><br>public void test<span class="hljs-constructor">WithExplicitLocalMethodSource(String <span class="hljs-params">name</span>)</span> &#123;<br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(name);<br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Assertions</span>.</span></span><span class="hljs-keyword">assert</span><span class="hljs-constructor">NotNull(<span class="hljs-params">name</span>)</span>;<br>&#125;<br><br>static Stream&lt;String&gt; <span class="hljs-keyword">method</span><span class="hljs-literal">()</span> &#123;<br>    return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Stream</span>.</span></span><span class="hljs-keyword">of</span>(<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="7、迁移指南"><a href="#7、迁移指南" class="headerlink" title="7、迁移指南"></a>7、迁移指南</h3><p>在进行迁移的时候需要注意如下的变化：</p>
<ul>
<li>注解在 org.junit.jupiter.api 包中，断言在 org.junit.jupiter.api.Assertions 类中，前置条件在 org.junit.jupiter.api.Assumptions 类中。</li>
<li>把@Before 和@After 替换成@BeforeEach 和@AfterEach。</li>
<li>把@BeforeClass 和@AfterClass 替换成@BeforeAll 和@AfterAll。</li>
<li>把@Ignore 替换成@Disabled。</li>
<li>把@Category 替换成@Tag。</li>
<li>把@RunWith、@Rule 和@ClassRule 替换成@ExtendWith。</li>
</ul>
<h2 id="八、指标监控"><a href="#八、指标监控" class="headerlink" title="八、指标监控"></a>八、指标监控</h2><h3 id="1、SpringBoot-Actuator"><a href="#1、SpringBoot-Actuator" class="headerlink" title="1、SpringBoot Actuator"></a>1、SpringBoot Actuator</h3><h4 id="1、简介"><a href="#1、简介" class="headerlink" title="1、简介"></a>1、简介</h4><p>未来每一个微服务在云上部署以后，我们都需要对其进行监控、追踪、审计、控制等。SpringBoot就抽取了Actuator场景，使得我们每个微服务快速引用即可获得生产级别的应用监控、审计等功能。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><img    class="lazyload" data-original="https://cdn.nlark.com/yuque/0/2020/png/1354552/1606886483335-697ee1c1-2f69-43ab-bddc-3a038382319c.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image.png</span></p>
<h3 id="2、1-x与2-x的不同"><a href="#2、1-x与2-x的不同" class="headerlink" title="2、1.x与2.x的不同"></a>2、1.x与2.x的不同</h3><p><img    class="lazyload" data-original="https://cdn.nlark.com/yuque/0/2020/png/1354552/1606884394162-ac7f2d8e-7abb-44df-9998-fb0f2705f238.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_14%2Ctext_YXRndWlndS5jb20g5bCa56GF6LC3%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image.png</span></p>
<h3 id="3、如何使用"><a href="#3、如何使用" class="headerlink" title="3、如何使用"></a>3、如何使用</h3><ul>
<li>引入场景</li>
<li>访问 <a href="http://localhost:8080/actuator/" target="_blank" rel="noopener">http://localhost:8080/actuator/</a>**</li>
<li>暴露所有监控信息为HTTP</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">management:</span><br>  <span class="hljs-attr">endpoints:</span><br>    <span class="hljs-attr">enabled-by-default:</span> <span class="hljs-literal">true</span> <span class="hljs-comment">#暴露所有端点信息</span><br>    <span class="hljs-attr">web:</span><br>      <span class="hljs-attr">exposure:</span><br>        <span class="hljs-attr">include:</span> <span class="hljs-string">'*'</span>  <span class="hljs-comment">#以web方式暴露</span><br></code></pre></td></tr></table></figure>

<ul>
<li>测试</li>
</ul>
<p><a href="http://localhost:8080/actuator/beans" target="_blank" rel="noopener">http://localhost:8080/actuator/beans</a></p>
<p><a href="http://localhost:8080/actuator/configprops" target="_blank" rel="noopener">http://localhost:8080/actuator/configprops</a></p>
<p><a href="http://localhost:8080/actuator/metrics" target="_blank" rel="noopener">http://localhost:8080/actuator/metrics</a></p>
<p><a href="http://localhost:8080/actuator/metrics/jvm.gc.pause" target="_blank" rel="noopener">http://localhost:8080/actuator/metrics/jvm.gc.pause</a></p>
<p><a href="http://localhost:8080/actuator/metrics" target="_blank" rel="noopener">http://localhost:8080/actuator/</a>endpointName/detailPath<br>。。。。。。</p>
<h3 id="4、可视化"><a href="#4、可视化" class="headerlink" title="4、可视化"></a>4、可视化</h3><p><a href="https://github.com/codecentric/spring-boot-admin" target="_blank" rel="noopener">https://github.com/codecentric/spring-boot-admin</a></p>
<ul>
<li><p>编写一个服务器项目，专门用来监控客户端</p>
</li>
<li><p>然后导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>de.codecentric<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-admin-starter-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  #可视化工具依赖，需搭配web依赖使用<br></code></pre></td></tr></table></figure>
</li>
<li><p>在主程序上编写@EnableAdminServer</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@EnableAdminServer</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProjectadminserviceApplication</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SpringApplication.run(ProjectadminserviceApplication<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">args</span>)</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>端口号不能与客户端一致</p>
</li>
<li><p>在客户端引入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>de.codecentric<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-admin-starter-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>在编写配置文件和服务器项目对应</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">spring</span><br>  <span class="hljs-attr">boot:</span><br>    <span class="hljs-attr">admin:</span><br>      <span class="hljs-attr">client:</span><br>        <span class="hljs-attr">url:</span> <span class="hljs-string">http://localhost:8081</span> <span class="hljs-comment">#对应服务器端项目的端口</span><br>        <span class="hljs-attr">instance:</span><br>          <span class="hljs-attr">prefer-ip:</span> <span class="hljs-literal">true</span> <span class="hljs-comment">#使用IP注册进来，不然注册进去的会是电脑名字</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">project6</span> <span class="hljs-comment">#表明当前项目名</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>实例化页面</p>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210306161026928.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210306161026928</span></p>
</li>
<li><p>一个六边形代表一个项目，12m表示运行了12分钟</p>
</li>
</ul>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210306161052856.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210306161052856</span></p>
<h3 id="2、Actuator-Endpoint"><a href="#2、Actuator-Endpoint" class="headerlink" title="2、Actuator Endpoint"></a>2、Actuator Endpoint</h3><h4 id="1、最常使用的端点"><a href="#1、最常使用的端点" class="headerlink" title="1、最常使用的端点"></a>1、最常使用的端点</h4><table>
<thead>
<tr>
<th>ID</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>auditevents</code></td>
<td>暴露当前应用程序的审核事件信息。需要一个<code>AuditEventRepository组件</code>。</td>
</tr>
<tr>
<td><code>beans</code></td>
<td>显示应用程序中所有Spring Bean的完整列表。</td>
</tr>
<tr>
<td><code>caches</code></td>
<td>暴露可用的缓存。</td>
</tr>
<tr>
<td><code>conditions</code></td>
<td>显示自动配置的所有条件信息，包括匹配或不匹配的原因。</td>
</tr>
<tr>
<td><code>configprops</code></td>
<td>显示所有<code>@ConfigurationProperties</code>。</td>
</tr>
<tr>
<td><code>env</code></td>
<td>暴露Spring的属性<code>ConfigurableEnvironment</code></td>
</tr>
<tr>
<td><code>flyway</code></td>
<td>显示已应用的所有Flyway数据库迁移。 需要一个或多个<code>Flyway</code>组件。</td>
</tr>
<tr>
<td><code>health</code></td>
<td>显示应用程序运行状况信息。</td>
</tr>
<tr>
<td><code>httptrace</code></td>
<td>显示HTTP跟踪信息（默认情况下，最近100个HTTP请求-响应）。需要一个<code>HttpTraceRepository</code>组件。</td>
</tr>
<tr>
<td><code>info</code></td>
<td>显示应用程序信息。</td>
</tr>
<tr>
<td><code>integrationgraph</code></td>
<td>显示Spring <code>integrationgraph</code> 。需要依赖<code>spring-integration-core</code>。</td>
</tr>
<tr>
<td><code>loggers</code></td>
<td>显示和修改应用程序中日志的配置。</td>
</tr>
<tr>
<td><code>liquibase</code></td>
<td>显示已应用的所有Liquibase数据库迁移。需要一个或多个<code>Liquibase</code>组件。</td>
</tr>
<tr>
<td><code>metrics</code></td>
<td>显示当前应用程序的“指标”信息。</td>
</tr>
<tr>
<td><code>mappings</code></td>
<td>显示所有<code>@RequestMapping</code>路径列表。</td>
</tr>
<tr>
<td><code>scheduledtasks</code></td>
<td>显示应用程序中的计划任务。</td>
</tr>
<tr>
<td><code>sessions</code></td>
<td>允许从Spring Session支持的会话存储中检索和删除用户会话。需要使用Spring Session的基于Servlet的Web应用程序。</td>
</tr>
<tr>
<td><code>shutdown</code></td>
<td>使应用程序正常关闭。默认禁用。</td>
</tr>
<tr>
<td><code>startup</code></td>
<td>显示由<code>ApplicationStartup</code>收集的启动步骤数据。需要使用<code>SpringApplication</code>进行配置<code>BufferingApplicationStartup</code>。</td>
</tr>
<tr>
<td><code>threaddump</code></td>
<td>执行线程转储。</td>
</tr>
</tbody></table>
<p>如果您的应用程序是Web应用程序（Spring MVC，Spring WebFlux或Jersey），则可以使用以下附加端点：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>heapdump</code></td>
<td>返回<code>hprof</code>堆转储文件。</td>
</tr>
<tr>
<td><code>jolokia</code></td>
<td>通过HTTP暴露JMX bean（需要引入Jolokia，不适用于WebFlux）。需要引入依赖<code>jolokia-core</code>。</td>
</tr>
<tr>
<td><code>logfile</code></td>
<td>返回日志文件的内容（如果已设置<code>logging.file.name</code>或<code>logging.file.path</code>属性）。支持使用HTTP<code>Range</code>标头来检索部分日志文件的内容。</td>
</tr>
<tr>
<td><code>prometheus</code></td>
<td>以Prometheus服务器可以抓取的格式公开指标。需要依赖<code>micrometer-registry-prometheus</code>。</td>
</tr>
</tbody></table>
<p>最常用的Endpoint</p>
<ul>
<li><strong>Health：监控状况</strong></li>
<li><strong>Metrics：运行时指标</strong></li>
<li><strong>Loggers：日志记录</strong></li>
</ul>
<h3 id="2、Health-Endpoint"><a href="#2、Health-Endpoint" class="headerlink" title="2、Health Endpoint"></a>2、Health Endpoint</h3><p>健康检查端点，我们一般用于在云平台，平台会定时的检查应用的健康状况，我们就需要Health Endpoint可以为平台返回当前应用的一系列组件健康状况的集合。</p>
<p>重要的几点：</p>
<ul>
<li><p>health endpoint返回的结果，应该是一系列健康检查后的一个汇总报告</p>
</li>
<li><p>很多的健康检查默认已经自动配置好了，比如：数据库、redis等</p>
</li>
<li><p>可以很容易的添加自定义的健康检查机制</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">endpoint:</span><br>    <span class="hljs-attr">health:</span><br>      <span class="hljs-attr">show-details:</span> <span class="hljs-string">always</span> <span class="hljs-string">//开启详细的健康检查报告</span><br></code></pre></td></tr></table></figure>



</li>
</ul>
<p><img    class="lazyload" data-original="https://cdn.nlark.com/yuque/0/2020/png/1354552/1606908975702-4f9a3208-15ca-4a78-9f76-939ef986db7e.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image.png</span></p>
<h3 id="3、Metrics-Endpoint"><a href="#3、Metrics-Endpoint" class="headerlink" title="3、Metrics Endpoint"></a>3、Metrics Endpoint</h3><p>提供详细的、层级的、空间指标信息，这些信息可以被pull（主动推送）或者push（被动获取）方式得到；</p>
<ul>
<li>通过Metrics对接多种监控系统</li>
<li>简化核心Metrics开发</li>
<li>添加自定义Metrics或者扩展已有Metrics</li>
</ul>
<p><img    class="lazyload" data-original="https://cdn.nlark.com/yuque/0/2020/png/1354552/1606909073222-c6e77ca3-4b1c-4f38-a1c6-8614dec4f7bc.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image.png</span></p>
<h3 id="4、管理Endpoints"><a href="#4、管理Endpoints" class="headerlink" title="4、管理Endpoints"></a>4、管理Endpoints</h3><h4 id="1、开启与禁用Endpoints"><a href="#1、开启与禁用Endpoints" class="headerlink" title="1、开启与禁用Endpoints"></a>1、开启与禁用Endpoints</h4><ul>
<li>默认所有的Endpoint除过shutdown都是开启的。</li>
<li>需要开启或者禁用某个Endpoint。配置模式为  <strong>management.endpoint.**</strong><endpointName><strong>**.enabled = true</strong></li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">management:</span><br>  <span class="hljs-attr">endpoint:</span><br>    <span class="hljs-attr">beans:</span><br>      <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<ul>
<li>或者禁用所有的Endpoint然后手动开启指定的Endpoint</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">management:</span><br>  <span class="hljs-attr">endpoints:</span><br>    <span class="hljs-attr">enabled-by-default:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">endpoint:</span><br>    <span class="hljs-attr">beans:</span><br>      <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">health:</span><br>      <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>





<h3 id="2、暴露Endpoints"><a href="#2、暴露Endpoints" class="headerlink" title="2、暴露Endpoints"></a>2、暴露Endpoints</h3><p>支持的暴露方式</p>
<ul>
<li>HTTP：默认只暴露<strong>health</strong>和<strong>info</strong> Endpoint</li>
<li><strong>JMX</strong>：默认暴露所有Endpoint</li>
<li>除过health和info，剩下的Endpoint都应该进行保护访问。如果引入SpringSecurity，则会默认配置安全访问规则</li>
</ul>
<table>
<thead>
<tr>
<th>ID</th>
<th>JMX</th>
<th>Web</th>
</tr>
</thead>
<tbody><tr>
<td><code>auditevents</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>beans</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>caches</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>conditions</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>configprops</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>env</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>flyway</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>health</code></td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td><code>heapdump</code></td>
<td>N/A</td>
<td>No</td>
</tr>
<tr>
<td><code>httptrace</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>info</code></td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td><code>integrationgraph</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>jolokia</code></td>
<td>N/A</td>
<td>No</td>
</tr>
<tr>
<td><code>logfile</code></td>
<td>N/A</td>
<td>No</td>
</tr>
<tr>
<td><code>loggers</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>liquibase</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>metrics</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>mappings</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>prometheus</code></td>
<td>N/A</td>
<td>No</td>
</tr>
<tr>
<td><code>scheduledtasks</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>sessions</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>shutdown</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>startup</code></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><code>threaddump</code></td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody></table>
<h3 id="3-定制化Endpoints"><a href="#3-定制化Endpoints" class="headerlink" title="3.定制化Endpoints"></a>3.定制化Endpoints</h3><h4 id="1-定制health信息"><a href="#1-定制health信息" class="headerlink" title="1.定制health信息"></a>1.定制health信息</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyHealthIndicator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractHealthIndicator</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    StringRedisTemplate stringRedisTemplate;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 真实的检查方法</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> builder</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Exception</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doHealthCheck</span><span class="hljs-params">(Health.Builder builder)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        Map&lt;String,Object&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>        <span class="hljs-keyword">if</span>(stringRedisTemplate!=<span class="hljs-keyword">null</span>)&#123;<br>            builder.status(Status.UP); <span class="hljs-comment">//健康</span><br>            map.put(<span class="hljs-string">"msg"</span>,<span class="hljs-string">"redis导入成功"</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            builder.status(Status.DOWN); <span class="hljs-comment">//不健康</span><br>            map.put(<span class="hljs-string">"error"</span>,<span class="hljs-string">"redis导入失败"</span>);<br>        &#125;<br>        builder.withDetail(<span class="hljs-string">"code"</span>,<span class="hljs-string">"100"</span>);<br>        builder.withDetails(map);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210305163341673.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210305163341673</span></p>
<h4 id="2-定制info"><a href="#2-定制info" class="headerlink" title="2.定制info"></a>2.定制info</h4><ul>
<li><p>yaml配置文件方式</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">info:</span><br>  <span class="hljs-attr">appName:</span> <span class="hljs-string">Project6</span><br>  <span class="hljs-attr">hello:</span> <span class="hljs-string">world</span><br>  <span class="hljs-attr">mavenProjectName:</span> <span class="hljs-string">@project.artifactId@</span> <span class="hljs-comment">#使用@@可以获取maven的pom文件值</span><br>  <span class="hljs-attr">mavenVersoin:</span> <span class="hljs-string">@project.version@</span><br></code></pre></td></tr></table></figure>



</li>
</ul>
<p>  <img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210305164109087.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210305164109087</span></p>
<ul>
<li><p>配置类方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppInfoInfoContributor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">InfoContributor</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contribute</span><span class="hljs-params">(Info.Builder builder)</span> </span>&#123;<br>        builder.withDetail(<span class="hljs-string">"redis实例"</span>,<span class="hljs-string">"redis实例化成功"</span>)<br>                .withDetail(<span class="hljs-string">"Redis工厂类型"</span>,<span class="hljs-string">"jedis"</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



</li>
</ul>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210305165010088.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210305165010088</span></p>
<h4 id="3-定制Metrics信息"><a href="#3-定制Metrics信息" class="headerlink" title="3.定制Metrics信息"></a>3.定制Metrics信息</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CityServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CityService</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    CityMapper cityMapper;<br><br>    Counter counter;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CityServiceImpl</span><span class="hljs-params">(MeterRegistry meterRegistry)</span></span>&#123;<br>        counter  = meterRegistry.counter(<span class="hljs-string">"CityServiceImpl.getCity.count"</span>);<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> City <span class="hljs-title">getCity</span><span class="hljs-params">()</span> </span>&#123;<br>        counter.increment();<br>        <span class="hljs-keyword">return</span> cityMapper.getCity();<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210305172444444.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210305172444444</span></p>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210305172528503.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210305172528503</span></p>
<h4 id="4-定制Endpoint"><a href="#4-定制Endpoint" class="headerlink" title="4.定制Endpoint"></a>4.定制Endpoint</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Endpoint</span>(id = <span class="hljs-string">"myService"</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyServiceEndPoint</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    CityService cityService;<br>    <span class="hljs-meta">@ReadOperation</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getCity</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> cityService.getCity();<br>    &#125;<br>    <span class="hljs-meta">@WriteOperation</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stopCity</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">"停止访问"</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210305174312947.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210305174312947</span></p>
<h2 id="九、自定义Starter"><a href="#九、自定义Starter" class="headerlink" title="九、自定义Starter"></a>九、自定义Starter</h2><ol>
<li><strong>创建一个空工程</strong></li>
</ol>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210307151543012.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210307151543012</span></p>
<ol start="2">
<li><p><strong>在工厂中创建两个模块</strong></p>
<ul>
<li>上面是maven模块来编写场景启动器，给别人引用 /下面是springboot模块负责编写自动配置相关的东西。</li>
<li><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210307151637497.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210307151637497</span></li>
</ul>
</li>
<li><p><strong>在场景启动器中引入自动配置的依赖</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.project<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>project-hello-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.project<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>project-hello-spring-boot-starter-autoconfigure<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>删除自动配置里面没用的东西</strong></p>
<ul>
<li>pom.xml文件里面只留下spring-boot-starter即可</li>
</ul>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ul>
<li><p>删掉项目里没有的类和配置文件（蓝色背景的都删除）</p>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210307152926353.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210307152926353</span></p>
</li>
</ul>
<ol start="5">
<li><p><strong>编写一个自动配置方法</strong></p>
<ul>
<li><p>service包下的PostService类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 默认不放在容器中</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostService</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    PostProperties postProperties;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">introDuce</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> postProperties.getName()+<span class="hljs-string">"是一个"</span>+postProperties.getPosition();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ol>
<ul>
<li><p>bean包下的PostProperties类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ConfigurationProperties</span>(<span class="hljs-string">"project.post"</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostProperties</span> </span>&#123;<br>    <span class="hljs-keyword">private</span>  String name;<br>    <span class="hljs-keyword">private</span>  String position;<br><span class="hljs-comment">//省略get，set方法</span><br></code></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>auto包下的PostServiceAutoConfiguration类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@ConditionalOnMissingBean</span>(PostService<span class="hljs-class">.<span class="hljs-keyword">class</span>) //条件装配，你没有这个组件就自动注入</span><br><span class="hljs-class">@<span class="hljs-title">EnableConfigurationProperties</span>(<span class="hljs-title">PostProperties</span>.<span class="hljs-title">class</span>) //默认将<span class="hljs-title">PostProperties</span>放在容器中</span><br><span class="hljs-class"><span class="hljs-title">public</span> <span class="hljs-title">class</span> <span class="hljs-title">PostServiceAutoConfiguration</span> </span>&#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> PostService <span class="hljs-title">postService</span><span class="hljs-params">()</span></span>&#123;<br>        PostService postService = <span class="hljs-keyword">new</span> PostService();<br>        <span class="hljs-keyword">return</span> postService;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<ol start="6">
<li><p><strong>编写META-INF/spring.factories中EnableAutoConfiguration 的值，使得项目启动加载指定的自动配置类**</strong></p>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210307165820513.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210307165820513</span></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs factories"># Auto Configure<br>org.springframework.boot.autoconfigure.EnableAutoConfiguration&#x3D;\<br>com.project.auto.PostServiceAutoConfiguration<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>将模块安装到maven目录中先安装自动装配模块</strong></p>
</li>
</ol>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210307165949877.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210307165949877</span></p>
<ol start="8">
<li><p><strong>在新项目中引入自定义的Starter</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.project<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>project-hello-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>引入成功就可以使用了</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">project:</span><br>  <span class="hljs-attr">post:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">张三</span><br>    <span class="hljs-attr">position:</span> <span class="hljs-string">经理</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br>    PostService postService;<br><span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/introDuce"</span>)<br>    <span class="hljs-function"><span class="hljs-keyword">public</span>  String <span class="hljs-title">getIntroDuce</span><span class="hljs-params">()</span></span>&#123;<br>        String s = postService.introDuce();<br>        <span class="hljs-keyword">return</span> s;<br>    &#125;<br></code></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li><p>效果</p>
<p><img    class="lazyload" data-original="C:%5CUsers%5C86176%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210307170517495.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="   ><span class="image-caption">image-20210307170517495</span></p>
</li>
</ul>
<h2 id="十、SpringBoot原理（以后再看）"><a href="#十、SpringBoot原理（以后再看）" class="headerlink" title="十、SpringBoot原理（以后再看）"></a>十、SpringBoot原理（以后再看）</h2>
      </section>
      <section class="extra">
        
          <ul class="copyright">
  
    <li><strong>本文作者：</strong>周瑜</li>
    <li><strong>本文链接：</strong><a href="http://yoursite.com/2021/03/07/SpringBoot2/index.html" title="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;03&#x2F;07&#x2F;SpringBoot2&#x2F;index.html">http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;03&#x2F;07&#x2F;SpringBoot2&#x2F;index.html</a></li>
    <li><strong>版权声明：</strong>本博客所有文章均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" title="BY-NC-SA" target="_blank" rel="noopener">BY-NC-SA</a> 许可协议，转载请注明出处！</li>
  
</ul>
        
        
          <section class="donate">
  <div id="qrcode-donate">
    <img   class="lazyload" data-original="https://pic.izhaoo.com/alipay.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" >
  </div>
  <div class="icon">
    <a href="javascript:;" id="alipay"><i class="iconfont iconalipay"></i></a>
    <a href="javascript:;" id="wechat"><i class="iconfont iconwechat-fill"></i></a>
  </div>
</section>
        
        
        
  <nav class="nav">
    <a></a>
    <a href="/2020/07/05/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%96%87%E7%AB%A0/">我的第一篇博客文章<i class="iconfont iconright"></i></a>
  </nav>

      </section>
      
    </section>
  </div>
</article></div>
      <div class="col-xl-3">
        
          
  <aside class="toc-wrap">
    <h3 class="toc-title">文章目录：</h3>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#一-容器功能"><span class="toc-text">一.容器功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二-自动配置原理"><span class="toc-text">二.自动配置原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、开发小技巧"><span class="toc-text">三、开发小技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、配置文件"><span class="toc-text">四、配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#五、web开发（源码以后再看）"><span class="toc-text">五、web开发（源码以后再看）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-简单功能分析"><span class="toc-text">2.简单功能分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1静态资源访问"><span class="toc-text">2.1静态资源访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2、欢迎页支持"><span class="toc-text">2.2、欢迎页支持</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3、自定义-Favicon"><span class="toc-text">2.3、自定义 Favicon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4、静态资源配置原理"><span class="toc-text">2.4、静态资源配置原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、请求参数处理"><span class="toc-text">3、请求参数处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、rest使用与原理"><span class="toc-text">1、rest使用与原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-文件上传"><span class="toc-text">5.文件上传</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-异常处理"><span class="toc-text">6.异常处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-Web原生组件注入（servlet，Filter，Listener）"><span class="toc-text">7.Web原生组件注入（servlet，Filter，Listener）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、数据访问"><span class="toc-text">六、数据访问</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-整合druid数据源"><span class="toc-text">1.整合druid数据源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-整合Mybatis"><span class="toc-text">2.整合Mybatis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、整合Mybatis-Plus"><span class="toc-text">3、整合Mybatis-Plus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-整合Redis"><span class="toc-text">4.整合Redis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七、单元测试"><span class="toc-text">七、单元测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、JUnit5-的变化"><span class="toc-text">1、JUnit5 的变化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、JUnit5常用注解"><span class="toc-text">2、JUnit5常用注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、断言（assertions）"><span class="toc-text">3、断言（assertions）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、数组断言"><span class="toc-text">2、数组断言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、组合断言"><span class="toc-text">3、组合断言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、异常断言"><span class="toc-text">4、异常断言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、超时断言"><span class="toc-text">5、超时断言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6、快速失败"><span class="toc-text">6、快速失败</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、前置条件（assumptions）"><span class="toc-text">4、前置条件（assumptions）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、嵌套测试"><span class="toc-text">5、嵌套测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6、参数化测试"><span class="toc-text">6、参数化测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7、迁移指南"><span class="toc-text">7、迁移指南</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#八、指标监控"><span class="toc-text">八、指标监控</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、SpringBoot-Actuator"><span class="toc-text">1、SpringBoot Actuator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、1-x与2-x的不同"><span class="toc-text">2、1.x与2.x的不同</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、如何使用"><span class="toc-text">3、如何使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、可视化"><span class="toc-text">4、可视化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、Actuator-Endpoint"><span class="toc-text">2、Actuator Endpoint</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、Health-Endpoint"><span class="toc-text">2、Health Endpoint</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、Metrics-Endpoint"><span class="toc-text">3、Metrics Endpoint</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、管理Endpoints"><span class="toc-text">4、管理Endpoints</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、暴露Endpoints"><span class="toc-text">2、暴露Endpoints</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-定制化Endpoints"><span class="toc-text">3.定制化Endpoints</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#九、自定义Starter"><span class="toc-text">九、自定义Starter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#十、SpringBoot原理（以后再看）"><span class="toc-text">十、SpringBoot原理（以后再看）</span></a>
  </aside>

        
      </div>
    </div>
  </div>
</main>
  

<footer class="footer">
  <div class="footer-social"><a 
        href="tencent://message/?Menu=yes&uin=1507127578 "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#12B7F5'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconQQ "></i>
      </a><a 
        href="javascript:; "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#09BB07'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconwechat-fill "></i>
      </a><a 
        href="https://www.instagram.com/izhaoo/ "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#DA2E76'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconinstagram "></i>
      </a><a 
        href="https://github.com/xinblog "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#9f7be1'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  icongithub-fill "></i>
      </a><a 
        href="mailto:1507127578@qq.com "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color=#FF3B00" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconmail"></i>
      </a></div>
  
    <div class="footer-copyright"><p>Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  Theme - <a target="_blank" href="https://github.com/izhaoo/hexo-theme-zhaoo">fan</a></p></div>
  
</footer>
  
      <div class="fab fab-plus">
    <i class="iconfont iconplus"></i>
  </div>
  
  
  <div class="fab fab-up">
    <i class="iconfont iconcaret-up"></i>
  </div>
  
  
    <div class="scrollbar j-scrollbar">
  <div class="scrollbar-current j-scrollbar-current"></div>
</div>
  
  
    
<script src="/js/color-mode.js"></script>

  
</body>

<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>



  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>




  
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>






  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js"></script>




<script src="/js/utils.js"></script>
<script src="/js/script.js"></script>







  <script>
    (function () {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>













</html>